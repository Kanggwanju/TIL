# ğŸ—“ï¸ 2025ë…„ 10ì›” 17ì¼ TIL

## ğŸ“Œ ì˜¤ëŠ˜ì˜ í‚¤ì›Œë“œ

`CI/CD` `Jenkins` `ìë™í™”` `Credentials` `Freestyle Project` `Pipeline` `Jenkinsfile` `GitHub Webhook` `Docker`

---

## ğŸ¤– CI/CDë€?

### CI (Continuous Integration, ì§€ì†ì  í†µí•©)
ê°œë°œìë“¤ì´ ì‘ì—…í•œ ì½”ë“œë¥¼ `git push`í•  ë•Œë§ˆë‹¤ ìë™ìœ¼ë¡œ ì½”ë“œë¥¼ í†µí•©í•˜ê³ , ë¹Œë“œ ë° í…ŒìŠ¤íŠ¸ë¥¼ ìˆ˜í–‰í•˜ì—¬ ì½”ë“œì— ë¬¸ì œê°€ ì—†ëŠ”ì§€ ê²€ì¦í•˜ëŠ” ë‹¨ê³„

### CD (Continuous Deployment, ì§€ì†ì  ë°°í¬)
CI ë‹¨ê³„ë¥¼ í†µê³¼í•œ ì½”ë“œë¥¼ ìë™ìœ¼ë¡œ ì‹¤ì œ ìš´ì˜ ì„œë²„(EKS)ê¹Œì§€ ë°°í¬í•´ì£¼ëŠ” ë‹¨ê³„

**í•µì‹¬**: ê°œë°œìëŠ” ì½”ë“œ ì‘ì„±ì—ë§Œ ì§‘ì¤‘í•˜ê³ , ë³µì¡í•œ ë°°í¬ ê³¼ì •ì€ ìë™í™” ì‹œìŠ¤í…œì´ ì²˜ë¦¬

---

## ğŸ”§ Jenkinsë€?

### ê°œë…
CI/CD íŒŒì´í”„ë¼ì¸ì„ êµ¬ì¶•í•  ìˆ˜ ìˆê²Œ í•´ì£¼ëŠ” ì˜¤í”ˆì†ŒìŠ¤ ìë™í™” ì„œë²„

### ì—­í• 
ìë™í™” ì¡°ë¦½ ê³µì¥ì˜ ì¤‘ì•™ ê´€ì œì‹¤ ì—­í• 
- "GitHubì— ì½”ë“œ ì˜¬ë¼ì˜¤ë©´ â†’ ë¹Œë“œ â†’ í…ŒìŠ¤íŠ¸ â†’ ECRì— ì—…ë¡œë“œ â†’ EKSì— ë°°í¬" ê°™ì€ ì‘ì—… ì‹œë‚˜ë¦¬ì˜¤(íŒŒì´í”„ë¼ì¸) ë“±ë¡ ë° ì‹¤í–‰

---

## ğŸš€ Jenkins ì„¤ì¹˜ ë° ì´ˆê¸° ì„¤ì •

### EC2 ì¸ìŠ¤í„´ìŠ¤ ì¤€ë¹„

#### 1. Jenkinsìš© EC2 ì¸ìŠ¤í„´ìŠ¤ ìƒì„±
- Dockerë¡œ Jenkins ì´ë¯¸ì§€ë¥¼ ë°›ì•„ì„œ EC2ì—ì„œ ì‹¤í–‰
- **íƒ„ë ¥ì  IP í• ë‹¹ í•„ìˆ˜**: GitHub Webhook ì„¤ì • ì‹œ ê³ ì • IP í•„ìš”

#### 2. Jenkins Docker ì»¨í…Œì´ë„ˆ ì‹¤í–‰
```bash
docker run -d -p 8080:8080 -p 50000:50000 \
  --name jenkins \
  -v jenkins_home:/var/jenkins_home \
  jenkins/jenkins:lts
```

---

### ì´ˆê¸° ì„¤ì •

#### 1. ì´ˆê¸° ë¹„ë°€ë²ˆí˜¸ í™•ì¸
```bash
# Jenkins ì»¨í…Œì´ë„ˆì— ì ‘ì†
docker exec -it jenkins bash

# ì´ˆê¸° ê´€ë¦¬ì ë¹„ë°€ë²ˆí˜¸ í™•ì¸
docker exec jenkins cat /var/jenkins_home/secrets/initialAdminPassword
```

#### 2. Jenkins ì›¹ ì ‘ì†
- ë¸Œë¼ìš°ì €ì—ì„œ `http://<EC2-Public-IP>:8080` ì ‘ì†
- ì´ˆê¸° ë¹„ë°€ë²ˆí˜¸ ì…ë ¥

#### 3. í”ŒëŸ¬ê·¸ì¸ ì„¤ì¹˜
- **Install suggested plugins** ì„ íƒ (ì¶”ì²œ í”ŒëŸ¬ê·¸ì¸ ìë™ ì„¤ì¹˜)
- í•„ìš”í•œ ì¶”ê°€ í”ŒëŸ¬ê·¸ì¸:
  - Git Plugin
  - GitHub Plugin
  - Pipeline Plugin
  - Docker Plugin

#### 4. ê´€ë¦¬ì ê³„ì • ìƒì„±
- Username, Password, Email ì„¤ì •
- ì´í›„ ì´ ê³„ì •ìœ¼ë¡œ Jenkins ë¡œê·¸ì¸

---

## ğŸ”‘ Credentials ì„¤ì •

### ê°œë…
Jenkinsì—ì„œ GitHub, DockerHub, AWS ë“± ì™¸ë¶€ ì„œë¹„ìŠ¤ ì¸ì¦ ì •ë³´ë¥¼ ì•ˆì „í•˜ê²Œ ê´€ë¦¬í•˜ëŠ” ê¸°ëŠ¥

### ì„¤ì • ë°©ë²•

#### 1. Credentials í˜ì´ì§€ ì ‘ì†
```
Jenkins ê´€ë¦¬ â†’ Manage Credentials â†’ Stores scoped to Jenkins â†’ (global) â†’ Add Credentials
```

#### 2. GitHub Token Credentials ì¶”ê°€

**GitHub Personal Access Token ìƒì„±**
1. GitHub Settings â†’ Developer settings â†’ Personal access tokens â†’ Generate new token
2. ê¶Œí•œ ì„¤ì •:
  - `repo` (ì „ì²´ ì„ íƒ)
  - `admin:repo_hook` (Webhook ê¶Œí•œ)
3. í† í° ë³µì‚¬ (ì¬í™•ì¸ ë¶ˆê°€í•˜ë¯€ë¡œ ì•ˆì „í•œ ê³³ì— ì €ì¥)

**Jenkinsì— Credentials ë“±ë¡**
- Kind: `Username with password`
- Username: GitHub ì‚¬ìš©ì ì´ë¦„
- Password: ìƒì„±í•œ Personal Access Token ë¶™ì—¬ë„£ê¸°
- ID: ì‹ë³„ìš© ID (ì˜ˆ: `github-token`)
- Description: ì„¤ëª… (ì˜ˆ: `GitHub Access Token`)

#### 3. DockerHub Credentials ì¶”ê°€
- Kind: `Username with password`
- Username: DockerHub ID
- Password: DockerHub Password
- ID: `dockerhub-credentials`

#### 4. SSH Private Key Credentials ì¶”ê°€ (ì„ íƒì‚¬í•­)
- Kind: `SSH Username with private key`
- Username: SSH ì‚¬ìš©ì ì´ë¦„
- Private Key: `Enter directly` ì„ íƒ í›„ Private Key ë‚´ìš© ë¶™ì—¬ë„£ê¸°
- ID: `ssh-private-key`

---

## ğŸ“‹ Freestyle Project ìƒì„±

### ê°œë…
Jenkinsì—ì„œ ê¸°ë³¸ì ì¸ ë¹Œë“œ ì‘ì—…ì„ ì„¤ì •í•  ìˆ˜ ìˆëŠ” í”„ë¡œì íŠ¸ ìœ í˜•
- ì²´í¬ë°•ìŠ¤ì™€ í…ìŠ¤íŠ¸ ì…ë ¥ìœ¼ë¡œ ì‰½ê²Œ ì„¤ì • ê°€ëŠ¥
- ê°„ë‹¨í•œ ì‘ì—…ì— ì í•©

### ìƒì„± ë°©ë²•

#### 1. ìƒˆë¡œìš´ Item ìƒì„±
```
Jenkins ëŒ€ì‹œë³´ë“œ â†’ ìƒˆë¡œìš´ Item â†’ Freestyle project ì„ íƒ â†’ ì´ë¦„ ì…ë ¥ â†’ OK
```

#### 2. í”„ë¡œì íŠ¸ ì„¤ì •

**General íƒ­**
- Description: í”„ë¡œì íŠ¸ ì„¤ëª… ì…ë ¥
- GitHub project: GitHub í”„ë¡œì íŠ¸ URL ì…ë ¥

**ì†ŒìŠ¤ ì½”ë“œ ê´€ë¦¬**
- Git ì„ íƒ
- Repository URL: GitHub ì €ì¥ì†Œ URL ì…ë ¥
- Credentials: ì•ì„œ ìƒì„±í•œ GitHub Credentials ì„ íƒ
- Branch Specifier: `*/main` ë˜ëŠ” `*/master`

**ë¹Œë“œ ìœ ë°œ (Build Triggers)**
- `GitHub hook trigger for GITScm polling` ì²´í¬
  - GitHubì— push ì‹œ ìë™ìœ¼ë¡œ ë¹Œë“œ ì‹¤í–‰

**ë¹Œë“œ í™˜ê²½**
- `Use secret text(s) or file(s)` (í•„ìš” ì‹œ)
  - Credentialsë¥¼ í™˜ê²½ ë³€ìˆ˜ë¡œ ë°”ì¸ë”©

**Build Steps**
```bash
# ì˜ˆì‹œ: Spring Boot í”„ë¡œì íŠ¸ ë¹Œë“œ
./gradlew clean build

# ë˜ëŠ” Maven
mvn clean package
```

**ë¹Œë“œ í›„ ì¡°ì¹˜ (Post-build Actions)**
- Archive the artifacts: ë¹Œë“œ ì‚°ì¶œë¬¼ ë³´ê´€
- Publish test results: í…ŒìŠ¤íŠ¸ ê²°ê³¼ ë°œí–‰

#### 3. ì €ì¥ ë° ë¹Œë“œ
- ì„¤ì • ì™„ë£Œ í›„ `Save`
- `Build Now` í´ë¦­í•˜ì—¬ ìˆ˜ë™ ë¹Œë“œ í…ŒìŠ¤íŠ¸
- Console Outputì—ì„œ ë¹Œë“œ ë¡œê·¸ í™•ì¸

---

## ğŸ”„ GitHub Webhook ì„¤ì •

### ëª©ì 
GitHubì— ì½”ë“œê°€ pushë˜ë©´ ìë™ìœ¼ë¡œ Jenkins ë¹Œë“œ ì‹¤í–‰

### ì„¤ì • ë°©ë²•

#### 1. GitHub Repository Settings
```
GitHub Repository â†’ Settings â†’ Webhooks â†’ Add webhook
```

#### 2. Webhook ì„¤ì •
- Payload URL: `http://<Jenkins-EC2-IP>:8080/github-webhook/`
- Content type: `application/json`
- Which events: `Just the push event`
- Active ì²´í¬

#### 3. ì—°ë™ í™•ì¸
- GitHubì— ì½”ë“œ push
- Jenkinsì—ì„œ ìë™ìœ¼ë¡œ ë¹Œë“œ ì‹œì‘ë˜ëŠ”ì§€ í™•ì¸

---

## ğŸ“ Pipelineê³¼ Jenkinsfile

### Pipelineì´ë€?
Freestyleë³´ë‹¤ ë°œì „ëœ í˜•íƒœë¡œ, ì½”ë“œë¡œ CI/CD íŒŒì´í”„ë¼ì¸ì„ ì •ì˜í•˜ëŠ” ë°©ì‹

### Freestyle vs Pipeline ë¹„êµ

| êµ¬ë¶„ | Freestyle | Pipeline |
|------|-----------|----------|
| **ì„¤ì • ë°©ì‹** | ì›¹ UIì—ì„œ ì²´í¬ë°•ìŠ¤/í…ìŠ¤íŠ¸ ì…ë ¥ | ì½”ë“œ(Jenkinsfile)ë¡œ ì‘ì„± |
| **ë²„ì „ ê´€ë¦¬** | ë¶ˆê°€ëŠ¥ | ê°€ëŠ¥ (Gitìœ¼ë¡œ ê´€ë¦¬) |
| **ë³µì¡í•œ íë¦„** | ì œí•œì  | ììœ ë¡œìš´ ì œì–´ ê°€ëŠ¥ |
| **ê°€ë…ì„±** | ì½˜ì†” ì¶œë ¥ë§Œ í™•ì¸ | Stageë³„ ì‹œê°í™” |
| **ì¬ì‚¬ìš©ì„±** | Job ë³µì‚¬ë¡œ ì¤‘ë³µ ë°œìƒ | ìŠ¤í¬ë¦½íŠ¸ ê³µìœ  ê°€ëŠ¥ |

---

### Jenkinsfile ì‘ì„±

#### 1. Pipeline í”„ë¡œì íŠ¸ ìƒì„±
```
Jenkins ëŒ€ì‹œë³´ë“œ â†’ ìƒˆë¡œìš´ Item â†’ Pipeline ì„ íƒ â†’ ì´ë¦„ ì…ë ¥ â†’ OK
```

#### 2. Pipeline ì„¤ì •

**Definition ì„ íƒ**
- `Pipeline script from SCM`: GitHubì— ìˆëŠ” Jenkinsfile ì‚¬ìš© (ê¶Œì¥)
- `Pipeline script`: Jenkins ì›¹ì—ì„œ ì§ì ‘ ì‘ì„±

**SCM ì„¤ì • (Pipeline script from SCM ì„ íƒ ì‹œ)**
- SCM: Git
- Repository URL: GitHub ì €ì¥ì†Œ URL
- Credentials: GitHub Credentials ì„ íƒ
- Branch: `*/main` ë˜ëŠ” `*/master`
- Script Path: `Jenkinsfile` (í”„ë¡œì íŠ¸ ë£¨íŠ¸ì— ìœ„ì¹˜)

---

### Jenkinsfile ë¬¸ë²•

#### Declarative Pipeline (ê¶Œì¥)

**ê¸°ë³¸ êµ¬ì¡°**
```groovy
pipeline {
    agent any
    
    environment {
        // í™˜ê²½ ë³€ìˆ˜ ì„¤ì •
        DOCKER_IMAGE = "myapp"
        DOCKER_TAG = "${env.BUILD_NUMBER}"
    }
    
    stages {
        stage('Checkout') {
            steps {
                // GitHubì—ì„œ ì½”ë“œ ê°€ì ¸ì˜¤ê¸°
                checkout scm
            }
        }
        
        stage('Build') {
            steps {
                script {
                    // Gradle ë¹Œë“œ
                    sh './gradlew clean build'
                }
            }
        }
        
        stage('Test') {
            steps {
                // í…ŒìŠ¤íŠ¸ ì‹¤í–‰
                sh './gradlew test'
            }
        }
        
        stage('Docker Build') {
            steps {
                script {
                    // Docker ì´ë¯¸ì§€ ë¹Œë“œ
                    sh "docker build -t ${DOCKER_IMAGE}:${DOCKER_TAG} ."
                }
            }
        }
        
        stage('Docker Push') {
            steps {
                script {
                    // DockerHubì— ì´ë¯¸ì§€ í‘¸ì‹œ
                    withCredentials([usernamePassword(
                        credentialsId: 'dockerhub-credentials',
                        usernameVariable: 'DOCKER_USER',
                        passwordVariable: 'DOCKER_PASS'
                    )]) {
                        sh """
                            echo ${DOCKER_PASS} | docker login -u ${DOCKER_USER} --password-stdin
                            docker push ${DOCKER_IMAGE}:${DOCKER_TAG}
                        """
                    }
                }
            }
        }
        
        stage('Deploy') {
            steps {
                // ë°°í¬ ìŠ¤í¬ë¦½íŠ¸ ì‹¤í–‰
                sh 'kubectl apply -f deployment.yml'
            }
        }
    }
    
    post {
        success {
            echo 'ë¹Œë“œ ì„±ê³µ!'
        }
        failure {
            echo 'ë¹Œë“œ ì‹¤íŒ¨!'
        }
        always {
            // í•­ìƒ ì‹¤í–‰ë˜ëŠ” ì‘ì—…
            cleanWs() // ì‘ì—… ê³µê°„ ì •ë¦¬
        }
    }
}
```

---

#### Scripted Pipeline (ê³ ê¸‰)

**ê¸°ë³¸ êµ¬ì¡°**
```groovy
node {
    stage('Checkout') {
        checkout scm
    }
    
    stage('Build') {
        sh './gradlew clean build'
    }
    
    stage('Test') {
        try {
            sh './gradlew test'
        } catch (Exception e) {
            currentBuild.result = 'FAILURE'
            throw e
        }
    }
    
    stage('Deploy') {
        if (currentBuild.result == null || currentBuild.result == 'SUCCESS') {
            sh 'kubectl apply -f deployment.yml'
        }
    }
}
```

---

### Pipeline Syntax ë„êµ¬ í™œìš©

**ì ‘ì† ë°©ë²•**
```
Jenkins í”„ë¡œì íŠ¸ í˜ì´ì§€ â†’ Pipeline Syntax
```

**ê¸°ëŠ¥**
- Snippet Generator: GUIë¡œ Pipeline ì½”ë“œ ìƒì„±
- Sample Step ì„ íƒ â†’ ì˜µì…˜ ì…ë ¥ â†’ Generate Pipeline Script í´ë¦­
- ìƒì„±ëœ ì½”ë“œë¥¼ Jenkinsfileì— ë³µì‚¬

**ì˜ˆì‹œ: Git Checkout**
```
Sample Step: checkout: Check out from version control
â†’ Git ì„ íƒ
â†’ Repository URL ì…ë ¥
â†’ Credentials ì„ íƒ
â†’ Generate Pipeline Script
```

---

## ğŸ¯ ìµœì¢… ì •ë¦¬

* **CI/CD**ëŠ” ì½”ë“œ í†µí•©ê³¼ ë°°í¬ë¥¼ ìë™í™”í•˜ì—¬ ê°œë°œìê°€ ì½”ë“œ ì‘ì„±ì—ë§Œ ì§‘ì¤‘í•  ìˆ˜ ìˆê²Œ í•¨
* **Jenkins**ëŠ” ì˜¤í”ˆì†ŒìŠ¤ CI/CD ìë™í™” ì„œë²„ë¡œ, Dockerë¡œ ì‰½ê²Œ ì„¤ì¹˜ ê°€ëŠ¥
* **Credentials**ë¥¼ í†µí•´ GitHub, DockerHub ë“±ì˜ ì¸ì¦ ì •ë³´ë¥¼ ì•ˆì „í•˜ê²Œ ê´€ë¦¬
* **Freestyle Project**ëŠ” ê°„ë‹¨í•œ ì‘ì—…ì— ì í•©í•˜ë©°, ì›¹ UIë¡œ ì‰½ê²Œ ì„¤ì • ê°€ëŠ¥
* **Pipeline**ì€ ì½”ë“œë¡œ CI/CD íë¦„ì„ ì •ì˜í•˜ë©°, **ë²„ì „ ê´€ë¦¬ ê°€ëŠ¥**í•˜ê³  **ì¬ì‚¬ìš©ì„±ì´ ë†’ìŒ**
* **Jenkinsfile**ì€ í”„ë¡œì íŠ¸ ë£¨íŠ¸ì— ìœ„ì¹˜í•˜ë©°, **Declarative Pipeline**ê³¼ **Scripted Pipeline** ë‘ ê°€ì§€ ë¬¸ë²• ì œê³µ
* **GitHub Webhook**ì„ ì„¤ì •í•˜ë©´ ì½”ë“œ push ì‹œ ìë™ìœ¼ë¡œ Jenkins ë¹Œë“œ ì‹¤í–‰
* **Pipeline Syntax ë„êµ¬**ë¥¼ í™œìš©í•˜ë©´ ë³µì¡í•œ ì½”ë“œë„ GUIë¡œ ì‰½ê²Œ ìƒì„± ê°€ëŠ¥
* ì‹¤ì œ í”„ë¡œì íŠ¸ì—ì„œëŠ” **Pipeline + Jenkinsfile** ì¡°í•©ì„ ì‚¬ìš©í•˜ëŠ” ê²ƒì´ ìœ ì§€ë³´ìˆ˜ì™€ í˜‘ì—…ì— ìœ ë¦¬