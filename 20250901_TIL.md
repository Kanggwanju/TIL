# ğŸ—“ï¸ 2025ë…„ 9ì›” 1ì¼ TIL

## ì˜¤ëŠ˜ì˜ í‚¤ì›Œë“œ
- CORS (í”„ë¡ íŠ¸-ë°±ì—”ë“œ ì„œë²„ ë¶„ë¦¬ í™˜ê²½ì—ì„œ ìš”ì²­ í—ˆìš© ì„¤ì •)
- Health Check (ì„œë²„ ìƒíƒœ í™•ì¸ìš© ì—”ë“œí¬ì¸íŠ¸)
- React Router Loader (í˜ì´ì§€ ë Œë”ë§ ì „ì— ë°ì´í„° ë¯¸ë¦¬ ê°€ì ¸ì˜¤ê¸°)
- useNavigate (ì½”ë“œë¡œ ë¼ìš°íŒ… ì œì–´)

---

# ğŸ“Œ React â†” Spring Boot ì„œë²„ ìš”ì²­ & CORS ì„¤ì •

### ğŸ”¹ í”„ë¡ íŠ¸/ë°±ì—”ë“œ ë¶„ë¦¬

* í”„ë¡ íŠ¸: React
* ë°±ì—”ë“œ: Spring Boot
* ì„œë²„ê°€ ë”°ë¡œ ì¡´ì¬í•˜ê¸° ë•Œë¬¸ì—, **í”„ë¡ íŠ¸ì—ì„œ ë°±ì—”ë“œë¡œ ìš”ì²­ ì‹œ CORS ì„¤ì • í•„ìš”**

---

## ğŸ”¹ CORS(Cross-Origin Resource Sharing) ì„¤ì •

### 1) ì „ì—­ ì„¤ì • í´ë˜ìŠ¤

```java
@Configuration
public class CorsConfig implements WebMvcConfigurer
```

### 2) í—ˆìš©í•  Origin ë°°ì—´ ê´€ë¦¬

```java
private String[] permitUrls = {
    "http://localhost:5173",
    "http://localhost:5174",
    "http://localhost:5175",
};
```

### 3) CORS ë§¤í•‘ ë“±ë¡

```java
@Override
public void addCorsMappings(CorsRegistry registry) {
    registry
        .addMapping("/api/**")          // ì–´ë–¤ ê²½ë¡œ í—ˆìš©?
        .allowedOrigins(permitUrls)     // í—ˆìš©í•  í´ë¼ì´ì–¸íŠ¸ URL
        .allowedMethods("*")            // í—ˆìš©í•  ìš”ì²­ ë°©ì‹ (GET, POST, PUT, DELETE...)
        .allowedHeaders("*")            // í—ˆìš©í•  í—¤ë”
        .allowCredentials(true);        // ë³´ì•ˆ ì¿ í‚¤ í—ˆìš© ì—¬ë¶€
}
```

---

## ğŸ”¹ ê° ë©”ì„œë“œ ì„¤ëª…

* **`addMapping`** â†’ í´ë¼ì´ì–¸íŠ¸ê°€ ì ‘ê·¼í•  ìˆ˜ ìˆëŠ” **ë°±ì—”ë“œ ê²½ë¡œ** ì§€ì •
* **`allowedOrigins`** â†’ í—ˆìš©í•  í´ë¼ì´ì–¸íŠ¸ **URL(origin)** ì§€ì •
* **`allowedMethods`** â†’ í—ˆìš©í•  **HTTP ë©”ì„œë“œ** (ì˜ˆ: `"GET"`, `"POST"`)
* **`allowedHeaders`** â†’ í—ˆìš©í•  **HTTP í—¤ë”**
* **`allowCredentials(true)`** â†’ **ë³´ì•ˆ ì¿ í‚¤(ì„¸ì…˜, JWT ë“±)** í¬í•¨ ì—¬ë¶€

---

### ğŸ“ í•µì‹¬ ìš”ì•½:

* React ê°œë°œ ì„œë²„(5173, 5174, 5175)ì—ì„œ Spring Boot API(`/api/**`) í˜¸ì¶œ ê°€ëŠ¥í•˜ë„ë¡ í—ˆìš©.
* CORSëŠ” **ë°±ì—”ë“œ ì„œë²„ê°€ í´ë¼ì´ì–¸íŠ¸ ìš”ì²­ì„ ë°›ì•„ë“¤ì¼ì§€ ì—¬ë¶€ë¥¼ ì •í•˜ëŠ” ê·œì¹™**.

---


# ğŸ“Œ í—¬ìŠ¤ ì²´í¬(Health Check) ì—”ë“œí¬ì¸íŠ¸

## ğŸ”¹ ê°œë…

* ë°°í¬ëœ API ì„œë²„ê°€ **ì •ìƒì ìœ¼ë¡œ ì‚´ì•„ìˆëŠ”ì§€, ì‘ë‹µ ê°€ëŠ¥í•œì§€** í™•ì¸í•˜ê¸° ìœ„í•´ ì‚¬ìš©í•˜ëŠ” ì—”ë“œí¬ì¸íŠ¸

---

## ğŸ”¹ ì½”ë“œ ì˜ˆì‹œ

```java
@RestController
@Slf4j
public class HealthCheckController {

    @GetMapping("/status")
    public ResponseEntity<?> healthCheck() {
        return ResponseEntity.ok(
            Map.of(
                "healthy", true,
                "timestamp", LocalDateTime.now()
            )
        );
    }
}
```

### ğŸ‘‰ `/status`ë¡œ GET ìš”ì²­ ì‹œ ì‘ë‹µ(JSON)

```json
{
  "healthy": true,
  "timestamp": "2025-09-01T12:34:56.789"
}
```

* `healthy: true` â†’ ì„œë²„ ì •ìƒ ë™ì‘
* `timestamp` â†’ í˜¸ì¶œ ì‹œì  ê¸°ë¡

---

## ğŸ”¹ ì‹¤ë¬´ì—ì„œì˜ ì“°ì„ìƒˆ

1. **ë¡œë“œ ë°¸ëŸ°ì„œ / ì¿ ë²„ë„¤í‹°ìŠ¤**

   * ELB, Nginx, Kubernetesê°€ `/status`ë¥¼ ì£¼ê¸°ì ìœ¼ë¡œ í˜¸ì¶œ
   * 200 OKë©´ ì •ìƒ â†’ íŠ¸ë˜í”½ ë¶„ë°° ìœ ì§€
   * ì‹¤íŒ¨ ì‹œ í•´ë‹¹ ì¸ìŠ¤í„´ìŠ¤ë¥¼ ì œì™¸

2. **ëª¨ë‹ˆí„°ë§**

   * Prometheus, Grafana ë“± ëª¨ë‹ˆí„°ë§ ì‹œìŠ¤í…œì—ì„œ ìƒíƒœ ìˆ˜ì§‘
   * ì‘ë‹µ ì§€ì—°, ì‹¤íŒ¨ìœ¨, ê°€ìš©ì„± ì²´í¬

3. **ê°œë°œ/ë””ë²„ê¹…**

   * ë¡œì»¬ì—ì„œ ê°„ë‹¨íˆ í™•ì¸ ê°€ëŠ¥
   * `curl http://localhost:8080/status` â†’ ì„œë²„ê°€ ì •ìƒ ê¸°ë™ ì¤‘ì¸ì§€ í™•ì¸

---

### ğŸ“ **í•µì‹¬ ìš”ì•½**

* í—¬ìŠ¤ ì²´í¬ = â€œì„œë²„ ì‚´ì•„ìˆë‚˜ìš”?â€ í™•ì¸ìš© API
* `/status` ì—”ë“œí¬ì¸íŠ¸ê°€ 200 OK ì‘ë‹µì„ ì£¼ë©´ ì„œë²„ ìƒíƒœ ì •ìƒ


---


# ğŸ“Œ React Router Loader ì •ë¦¬

### ğŸ”„ ë¦¬ì•¡íŠ¸ ë Œë”ë§ ê¸°ë³¸ ì‹¤í–‰ ìˆœì„œ

1. ë Œë”ë§ ìˆ˜í–‰
2. ì„œë²„ì—ì„œ ë°ì´í„° í˜ì¹­
3. ìƒíƒœ ë³€ìˆ˜ ë³€ê²½
4. ë‹¤ì‹œ ë Œë”ë§ ìˆ˜í–‰

ğŸ‘‰ ë¬¸ì œ: **í˜ì´ì§€ê°€ ë Œë”ë§ë˜ê¸° ì „ì— ë°ì´í„°ë¥¼ ë¯¸ë¦¬ ê°€ì ¸ì˜¤ê³  ì‹¶ë‹¤**
ğŸ‘‰ í•´ê²°: **`loader` í•¨ìˆ˜ ì‚¬ìš©**

---

## ğŸ”¹ loader í•¨ìˆ˜

* `loader`ëŠ” ë¼ìš°í„°ì—ì„œ ì‘ì„±í•œë‹¤.
* **ì–¸ì œ ì‹¤í–‰ë˜ë‚˜?**

   * í˜ì´ì§€ê°€ ë¼ìš°íŒ…ë  ë•Œ **ë‹¨ í•œ ë²ˆ** íŠ¸ë¦¬ê±°ë¨.

```jsx
{
  path: 'events',
  element: <EventLayout />,
  children: [
    {
      index: true,
      element: <EventPage />,
      loader: async () => {
        const response = await fetch('http://localhost:9000/api/events');
        return await response.json();
      }
    },
    {
      path: ':eventId',
      element: <EventDetailPage />
    }
  ]
}
```

---

## ğŸ”¹ useLoaderData()

* `loader`ê°€ ë¦¬í„´í•œ ë°ì´í„°ëŠ” í•´ë‹¹ í˜ì´ì§€ì™€ **ê·¸ í•˜ìœ„ ì»´í¬ë„ŒíŠ¸ì—ì„œ ì–¸ì œë“  ì‚¬ìš© ê°€ëŠ¥**í•˜ë‹¤.

```jsx
const eventList = useLoaderData();
```

---

## ğŸ”¹ loader ì½”ë“œ ë¶„ë¦¬ (ì•„ì›ƒì†Œì‹±)

* ë¼ìš°í„°ì— ì„œë²„ í†µì‹  ì½”ë“œë¥¼ ì§ì ‘ ì“°ë©´ ì½”ë“œê°€ ê¸¸ì–´ì§ â†’ ë³„ë„ íŒŒì¼ë¡œ ë¶„ë¦¬ ê¶Œì¥
* `loader`ê°€ `fetch` ê²°ê³¼ë¥¼ ë°”ë¡œ ë¦¬í„´í•˜ë©´, ì•Œì•„ì„œ `json` ì¶”ì¶œê¹Œì§€ í•´ì¤€ë‹¤.

```jsx
// route-config.jsx
import { eventDetailLoader } from '../loader/events-loader.js';

const router = createBrowserRouter([
  {
    path: ':eventId',
    element: <EventDetailPage />,
    loader: eventDetailLoader
  }
]);

// loader/events-loader.js
export const eventDetailLoader = async ({ params }) => {
  return await fetch(`http://localhost:9000/api/events/${params.eventId}`);
};
```

---

## ğŸ”¹ params ê°ì²´

* `params`ì—ëŠ” ë¼ìš°íŠ¸ ê²½ë¡œì—ì„œ ì •ì˜í•œ **ë™ì  íŒŒë¼ë¯¸í„° ê°’**ì´ ë“¤ì–´ê°„ë‹¤.
* ì˜ˆì‹œ

   * path: `":eventId"`
   * URL: `"/events/123"`
   * ê²°ê³¼: `params = { eventId: "123" }`

ğŸ‘‰ ì¦‰, `params`ë¥¼ í†µí•´ **í˜„ì¬ URLì´ ê°€ë¦¬í‚¤ëŠ” ë¦¬ì†ŒìŠ¤ì˜ id**ë¥¼ ê°€ì ¸ì˜¬ ìˆ˜ ìˆë‹¤.


---



# ğŸ“Œ useNavigate

* `useNavigate`ëŠ” `react-router-dom`ì—ì„œ ì œê³µí•˜ëŠ” í›…
* ì½”ë“œì—ì„œ `ë¼ìš°íŒ…`ì„ ì œì–´í•  ë•Œ ì‚¬ìš©
* `useNavigate()`ë¥¼ í˜¸ì¶œí•˜ë©´ `navigate` í•¨ìˆ˜ë¥¼ ë°˜í™˜
* `navigate("ê²½ë¡œ")`ë¥¼ ì‹¤í–‰í•˜ë©´ í•´ë‹¹ ê²½ë¡œë¡œ ì´ë™

### âœ¨ ì£¼ìš” ì‚¬ìš©ë²•

```jsx
import { useNavigate } from 'react-router-dom';

const Example = () => {
  const navigate = useNavigate();

  // íŠ¹ì • ê²½ë¡œ ì´ë™
  const goToHome = () => navigate('/');

  // ë’¤ë¡œê°€ê¸°
  const goBack = () => navigate(-1);

  // ì•ìœ¼ë¡œ ê°€ê¸°
  const goForward = () => navigate(1);

  // replace ì˜µì…˜: ë’¤ë¡œê°€ê¸° ê¸°ë¡ ë‚¨ê¸°ì§€ ì•ŠìŒ
  const goToLogin = () => navigate('/login', { replace: true });

  // state ì „ë‹¬
  const goWithState = () => navigate('/events', { state: { from: 'mypage' } });

  return (
    <>
      <button onClick={goToHome}>í™ˆ</button>
      <button onClick={goBack}>ë’¤ë¡œ</button>
      <button onClick={goToLogin}>ë¡œê·¸ì¸</button>
    </>
  );
}
```

### ğŸ“ useNavigate ì •ë¦¬

* `navigate('/path')` â†’ ì§€ì •í•œ ê²½ë¡œë¡œ ì´ë™
* `navigate(-1)` â†’ ë¸Œë¼ìš°ì € ë’¤ë¡œê°€ê¸°
* `navigate('/path', { replace: true })` â†’ ê¸°ë¡ì„ ë‚¨ê¸°ì§€ ì•Šê³  ì´ë™
* `navigate('/path', { state: {...} })` â†’ stateë¥¼ í•¨ê»˜ ì „ë‹¬ ê°€ëŠ¥

---

# âœ… ìµœì¢… ì •ë¦¬
- **CORS**: í”„ë¡ íŠ¸ì™€ ë°±ì—”ë“œê°€ ë¶„ë¦¬ëœ í™˜ê²½ì—ì„œ, ì–´ë–¤ í´ë¼ì´ì–¸íŠ¸ ìš”ì²­ì„ í—ˆìš©í• ì§€ ë°±ì—”ë“œì—ì„œ ì„¤ì • í•„ìš”
- **Health Check**: `/status` ê°™ì€ ë‹¨ìˆœ APIë¡œ ì„œë²„ ìƒíƒœ(Alive ì—¬ë¶€)ë¥¼ í™•ì¸ â†’ ë¡œë“œë°¸ëŸ°ì„œ, ëª¨ë‹ˆí„°ë§, ë””ë²„ê¹…ì— í™œìš©
- **React Router Loader**: ë¼ìš°íŒ… ì‹œì ì— ë°ì´í„°ë¥¼ ë¯¸ë¦¬ ê°€ì ¸ì™€ ì»´í¬ë„ŒíŠ¸ì—ì„œ ë°”ë¡œ í™œìš© ê°€ëŠ¥ â†’ `useLoaderData()`ë¡œ ì¡°íšŒ
- **useNavigate**: ì½”ë“œë¡œ ë¼ìš°íŒ…ì„ ì œì–´í•˜ëŠ” í›… â†’ ê²½ë¡œ ì´ë™, ë’¤ë¡œê°€ê¸°, replace ì´ë™, state ì „ë‹¬ ê°€ëŠ¥

  
