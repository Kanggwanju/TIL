
# 🗓️ 2025년 7월 22일 TIL - SQL 함수 정리

## ✅ 오늘의 핵심 키워드

* 문자열 함수 (`UPPER`, `LOWER`, `SUBSTR` 등)
* 숫자 함수 (`ROUND`, `MOD`, `CEIL` 등)
* 날짜 함수 (`ADD_MONTHS`, `TRUNC`, `TO_CHAR` 등)
* NULL 처리 함수 (`NVL`, `COALESCE`, `NULLIF`)
* 조건 표현 함수 (`CASE`, `DECODE`)

---

## 🅰️ 문자열 다루기 함수

### 🔠 대소문자 변환

| 함수             | 설명          |
| -------------- | ----------- |
| `UPPER(문자열)`   | 모든 문자를 대문자로 |
| `LOWER(문자열)`   | 모든 문자를 소문자로 |
| `INITCAP(문자열)` | 첫 글자만 대문자   |

```sql
SELECT
  username,
  UPPER(username) AS "대문자",
  LOWER(username) AS "소문자",
  INITCAP(username) AS "첫 글자만 대문자"
FROM USERS
WHERE user_id IN (9); -- hello_kitty 기준
```
[실행 결과]

| username    | 대문자로 변환 | 소문자로 변환 | 첫 글자만 대문자 |
| ----------- | ------------- | ------------- | ---------------- |
| hello_kitty | HELLO_KITTY   | hello_kitty   | Hello_kitty      |



---

### 📏 문자열 길이 & 위치

| 함수                 | 설명                 |
| ------------------ | ------------------ |
| `LENGTH(문자열)`      | 전체 길이 (공백 포함)      |
| `INSTR(문자열, '단어')` | 해당 단어가 몇 번째에 위치하는지 |

---

### ✂️ 문자열 자르기 & 붙이기

| 함수                      | 설명                 |   |         |
| ----------------------- | ------------------ | - | ------- |
| `SUBSTR(문자열, 시작위치, 길이)` | 문자열 일부 추출          |   |         |
| `CONCAT(문자열1, 문자열2)`    | 문자열 합치기 (또는 \`문자열1 |   | 문자열2\`) |

### ✂️ 문자열 자르기 & 붙이기

`SUBSTR(문자열, 시작 위치, 자를 길이)`: 문자열을 원하는 만큼 잘라냄
- 시작 위치에서 시작해서 자를 길이만큼 자르는 걸 의미
- 예) SUBSTR('일이삼사오육', 2, 3) -> 결과: '이삼사'

`CONCAT(문자열1, 문자열2)`: 두 문자열을 합침 (|| 연산자와 기능은 같음)

---

### 🧩 문자열 포맷 처리

| 함수                        | 설명         |
| ------------------------- | ---------- |
| `LPAD(문자열, 총길이, 채울문자)`    | 왼쪽 채우기     |
| `RPAD(문자열, 총길이, 채울문자)`    | 오른쪽 채우기    |
| `REPLACE(문자열, 바꿀문자, 새문자)` | 문자 치환      |
| `TRIM(문자열)`               | 공백 제거 (양옆) |

- REPLACE(p.content, '#일상', '#데일리') -> 결과: #일상이 #데일리로 변경됨
- REPLACE(p.content, '#일상') -> 결과: #일상이 모두 지워짐
---

## 🔢 숫자 함수

| 함수               | 설명  | 예시                          |
| ---------------- | --- | --------------------------- |
| `ROUND(숫자, 자리수)` | 반올림 | `ROUND(3.1415, 2)` → `3.14` |
| `TRUNC(숫자, 자리수)` | 버림  | `TRUNC(3.1415, 2)` → `3.14` |
| `CEIL(숫자)`       | 올림  | `CEIL(3.2)` → `4`           |
| `FLOOR(숫자)`      | 내림  | `FLOOR(3.9)` → `3`          |
| `MOD(숫자1, 숫자2)`  | 나머지 | `MOD(3, 2)` → `1`           |

---

## ⏰ 날짜 함수

### 📅 날짜 연산

| 함수                         | 설명            |
| -------------------------- | ------------- |
| `ADD_MONTHS(날짜, 개월수)`      | n개월 뒤 날짜      |
| `MONTHS_BETWEEN(날짜1, 날짜2)` | 개월 차이         |
| `LAST_DAY(날짜)`             | 해당 월의 마지막 날   |
| `NEXT_DAY(날짜, 요일)`         | 다음 특정 요일의 날짜      |
| `TRUNC(날짜, '기준')`          | 기준 단위로 날짜 버림  |
| `ROUND(날짜, '기준')`          | 기준 단위로 날짜 반올림 |

- NEXT_DAY(registration_date, '금요일')

#### ⏳ 날짜 + 숫자

| 연산               | 의미            |
| ---------------- | ------------- |
| `날짜 + 1`         | 하루 뒤          |
| `날짜 - 1`         | 하루 전          |
| `날짜1 - 날짜2`      | 두 날짜 사이 일수 차이 |
| `+ 1/24`         | 1시간 추가        |
| `+ 1/(24×60)`    | 1분 추가         |
| `+ 1/(24×60×60)` | 1초 추가         |

---

## 🔁 변환 함수

| 함수                     | 설명          |
| ---------------------- | ----------- |
| `TO_CHAR(날짜/숫자, '형식')` | 날짜/숫자를 문자열로 |
| `TO_DATE(문자열, '형식')`   | 문자열을 날짜로    |
| `TO_NUMBER(문자열)`       | 문자열을 숫자로    |

```markdown
TO_CHAR(registration_date, 'YYYY"년" MM"월" DD"일" MI"분"') -> 2020년 02월 08일 00분
TO_CHAR(registration_date, 'YYYY-MM-DD (DY)') -> 2020-02-08 (토)

WHERE creation_date > TO_DATE('2024-05-20', 'YYYY-MM-DD')
- 2024년 5월 20일 이후에 만들어진 것만 가져옴
```

---

## ⚠️ NULL 처리 함수

| 함수                      | 설명                  |
| ----------------------- |---------------------|
| `NVL(값, 대체값)`           | NULL이면 대체값 반환       |
| `NVL2(값, 참일 때, 거짓일 때)`  | 삼항 if               |
| `COALESCE(값1, 값2, ...)` | 첫 번째 NULL이 아닌 값     |
| `NULLIF(값1, 값2)`        | 값이 같으면 NULL, 다르면 값1 |

---

## 🧠 조건 표현식 (SQL의 IF문)

```sql
SELECT
  username,
  registration_date,
  CASE
    WHEN TO_CHAR(registration_date, 'YYYY') >= '2023' THEN '🌱 새싹 유저'
    WHEN TO_CHAR(registration_date, 'YYYY') >= '2021' THEN '🌳 기존 유저'
    ELSE '💎 고인물 유저'
  END AS "유저 등급",
  p.post_type,
  CASE p.post_type
    WHEN 'photo' THEN '사진'
    WHEN 'video' THEN '영상'
    ELSE '기타'
  END AS "게시물 종류"
FROM USERS u, POSTS p
WHERE u.user_id = p.user_id;
```

---

## ✅ 오늘의 학습 요약

| 분류      | 대표 함수                                         |
| ------- | --------------------------------------------- |
| 문자열 처리  | `UPPER`, `SUBSTR`, `REPLACE`, `LPAD`, `INSTR` |
| 숫자 처리   | `ROUND`, `CEIL`, `MOD`                        |
| 날짜 처리   | `ADD_MONTHS`, `LAST_DAY`, `TRUNC`, `ROUND`    |
| 변환 함수   | `TO_CHAR`, `TO_DATE`, `TO_NUMBER`             |
| NULL 처리 | `NVL`, `COALESCE`, `NULLIF`                   |
| 조건 처리   | `CASE`, `DECODE`                              |
