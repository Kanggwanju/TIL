
# ğŸ—“ï¸ 2025ë…„ 7ì›” 22ì¼ TIL

## âœ… ì˜¤ëŠ˜ì˜ í•µì‹¬ í‚¤ì›Œë“œ

* ìŠ¤í”„ë§ ë¶€íŠ¸ íŒŒì¼ ì—…ë¡œë“œ (`MultipartFile`)
* íŒŒì¼ ì €ì¥ ê²½ë¡œ ì„¤ì • (`application.yml`, `FileUploadConfig`)
* ì •ì  ìì› ë§¤í•‘ (`WebMvcConfigurer`)
* ì—…ë¡œë“œ íŒŒì¼ ê²€ì¦ (íƒ€ì…, í¬ê¸° ì œí•œ)
* JDBCì™€ MariaDB ì—°ê²° ê¸°ì´ˆ

---

## ğŸ“¦ íŒŒì¼ ì—…ë¡œë“œ ê°œìš”

### ğŸ”¹ íŒŒì¼ ì—…ë¡œë“œë€?

> í´ë¼ì´ì–¸íŠ¸ê°€ ìì‹ ì˜ ì»´í“¨í„°ì—ì„œ ì„œë²„ë¡œ íŒŒì¼(ì´ë¯¸ì§€, ì˜ìƒ ë“±)ì„ ì „ì†¡í•˜ëŠ” ì‘ì—…

---

## ğŸ“ Spring Bootì—ì„œ íŒŒì¼ ì—…ë¡œë“œ ì²˜ë¦¬

### ğŸ”¸ `MultipartFile` ê°ì²´

`MultipartFile`ì€ ì—…ë¡œë“œëœ íŒŒì¼ì„ ì²˜ë¦¬í•˜ê¸° ìœ„í•œ ìŠ¤í”„ë§ ì¸í„°í˜ì´ìŠ¤ì˜ˆìš”.

| ë©”ì„œë“œ                     | ì„¤ëª…                     |
| ----------------------- | ---------------------- |
| `getOriginalFilename()` | ì—…ë¡œë“œëœ íŒŒì¼ì˜ ì›ë˜ ì´ë¦„         |
| `getSize()`             | íŒŒì¼ í¬ê¸° (ë°”ì´íŠ¸ ë‹¨ìœ„)         |
| `getContentType()`      | MIME íƒ€ì… (ì˜ˆ: image/png) |
| `isEmpty()`             | íŒŒì¼ì´ ë¹„ì–´ ìˆëŠ”ì§€ í™•ì¸          |
| `transferTo(File dest)` | ì§€ì • ìœ„ì¹˜ë¡œ íŒŒì¼ ì €ì¥           |

---

## âš™ï¸ íŒŒì¼ ì—…ë¡œë“œ ì„¤ì •

### ğŸ”¸ `application.yml`

```yaml
spring:
  servlet:
    multipart:
      max-file-size: 10MB
      max-request-size: 100MB

file:
  upload:
    location: ${user.home}/spring/upload/
```

* ì—…ë¡œë“œ íŒŒì¼ì˜ í¬ê¸° ì œí•œ ì„¤ì •
* íŒŒì¼ ì €ì¥ ê²½ë¡œ ì„¤ì • (`${user.home}` ì‚¬ìš©í•´ OSë³„ ì‚¬ìš©ì í™ˆ ë””ë ‰í† ë¦¬ì— ì €ì¥)

> âš ï¸ yml íŒŒì¼ì€ ë³´ì•ˆìƒ `.gitignore`ì— ì¶”ê°€í•´ì„œ GitHubì— ì—…ë¡œë“œí•˜ì§€ ì•Šë„ë¡ ì£¼ì˜

---

### ğŸ”¸ `FileUploadConfig` í´ë˜ìŠ¤

```java
@Configuration
@Getter
public class FileUploadConfig {
    @Value("${file.upload.location}")
    private String location;

    @PostConstruct
    public void init() {
        File directory = new File(location);
        if (!directory.exists()) directory.mkdirs();
    }
}
```

#### âœ… ì—­í•  ì„¤ëª…

* `@Value`ë¥¼ í†µí•´ `application.yml`ì— ì„¤ì •ëœ íŒŒì¼ ê²½ë¡œ ì£¼ì…
* `@PostConstruct`ë¡œ ì„œë²„ ì‹¤í–‰ ì‹œ ë””ë ‰í† ë¦¬ ì¡´ì¬ ì—¬ë¶€ í™•ì¸ â†’ ì—†ìœ¼ë©´ ìë™ ìƒì„±

---

### ğŸ”¸ ì •ì  ìì› ë§¤í•‘ (`WebResourceConfig`)

```java
@Configuration
@RequiredArgsConstructor
public class WebResourceConfig implements WebMvcConfigurer {
    private final FileUploadConfig fileUploadConfig;

    @Override
    public void addResourceHandlers(ResourceHandlerRegistry registry) {
        registry.addResourceHandler("/uploads/**")
                .addResourceLocations("file:" + fileUploadConfig.getLocation());
    }
}
```

#### âœ… í•µì‹¬ í¬ì¸íŠ¸

* `/uploads/**`ë¡œ ë“¤ì–´ì˜¨ ìš”ì²­ì„ ë¡œì»¬ ë””ë ‰í† ë¦¬(`C:/Users/user/spring/upload/`)ì— ìˆëŠ” íŒŒì¼ë¡œ ì—°ê²°
* `WebMvcConfigurer` êµ¬í˜„ì„ í†µí•´ Springì˜ ê¸°ë³¸ ì›¹ ì„¤ì •ì„ ì»¤ìŠ¤í„°ë§ˆì´ì§•í•¨

---

## ğŸ“¤ íŒŒì¼ ì—…ë¡œë“œ ì»¨íŠ¸ë¡¤ëŸ¬

```java
@PostMapping("/uploads")
public ResponseEntity<?> uploadSingleFile(@RequestParam("profile") MultipartFile originFile) {
    String originFilename = originFile.getOriginalFilename();
    String extension = originFilename.substring(originFilename.lastIndexOf("."));
    String filename = UUID.randomUUID().toString() + extension;
    String fullName = fileUploadConfig.getLocation() + filename;

    try {
        originFile.transferTo(new File(fullName));
    } catch (IOException e) {
        return ResponseEntity.internalServerError().body("íŒŒì¼ ì €ì¥ ì‹¤íŒ¨!");
    }

    return ResponseEntity.ok("OK!!");
}
```

#### âœ… ì£¼ìš” ì²˜ë¦¬ íë¦„

1. ì—…ë¡œë“œëœ íŒŒì¼ ì´ë¦„ê³¼ í™•ì¥ì ì¶”ì¶œ
2. UUIDë¡œ ìƒˆë¡œìš´ íŒŒì¼ëª… ìƒì„± â†’ ë®ì–´ì“°ê¸° ë°©ì§€
3. ì„¤ì •ëœ ìœ„ì¹˜ì— íŒŒì¼ ì €ì¥
4. ì„±ê³µ/ì‹¤íŒ¨ì— ë”°ë¥¸ ì‘ë‹µ ë°˜í™˜

> ğŸ¯ íŒŒì¼ì´ë¦„ ì¶©ëŒ ë°©ì§€ë¥¼ ìœ„í•´ UUID ì‚¬ìš©
> ğŸ¯ íŒŒì¼ ë©”íƒ€ì •ë³´(íŒŒì¼ëª…, ì—…ë¡œë“œ ì¼ì‹œ, ì‚¬ìš©ì ì •ë³´)ëŠ” DBì— ì €ì¥í•˜ëŠ” ê²Œ ì¼ë°˜ì 

---

## ğŸ§ª íŒŒì¼ ê²€ì¦ ì²˜ë¦¬

### 1ï¸âƒ£ MIME íƒ€ì… ê²€ì¦

* `getContentType()`ìœ¼ë¡œ íŒŒì¼ íƒ€ì… í™•ì¸
* ì˜ˆ: `image/png`, `image/jpeg`ë§Œ í—ˆìš©

### 2ï¸âƒ£ íŒŒì¼ í¬ê¸° ì œí•œ

* `application.yml` ì„¤ì •:

```yaml
spring:
  servlet:
    multipart:
      max-file-size: 10MB
      max-request-size: 20MB
```

* `MultipartFile.getSize()` ë©”ì„œë“œë¡œ ì§ì ‘ ê²€ì‚¬ë„ ê°€ëŠ¥

---

## ğŸ—„ï¸ JDBC & MariaDB ì—°ê²° ê¸°ì´ˆ

### ğŸ”¹ ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²°ì„ ìœ„í•œ ì¤€ë¹„

* MariaDB ì„¤ì¹˜ (ë²„ì „ 11.4.7)
* IntelliJì—ì„œ ë°ì´í„° ì†ŒìŠ¤ ì¶”ê°€
* root ê³„ì • ì‚¬ìš©

### ğŸ”¹ ìƒˆ í”„ë¡œì íŠ¸ ì¢…ì†ì„±

* Lombok
* Spring Web
* Spring Data JPA
* MariaDB Driver

---

### ğŸ”¹ ì—°ê²°ì— í•„ìš”í•œ ì„¤ì • ìš”ì•½

1. **DB URL**

```text
jdbc:mariadb://localhost:3306/spring_study
```

2. **ê³„ì • ì •ë³´**

```text
username: root
password: mariadb
```

3. **JDBC ë“œë¼ì´ë²„**

* MariaDB ë“œë¼ì´ë²„ëŠ” ì˜ì¡´ì„±ì— í¬í•¨

4. **`application.yml` ì—°ê²° ì„¤ì •**

```yaml
spring.datasource.url=jdbc:mariadb://localhost:3306/spring_study
spring.datasource.username=root
spring.datasource.password=mariadb
```

---

## âœ… ì˜¤ëŠ˜ì˜ í•™ìŠµ ìš”ì•½

| í•­ëª©        | ìš”ì•½                                            |
| --------- | --------------------------------------------- |
| íŒŒì¼ ì—…ë¡œë“œ ì²˜ë¦¬ | `MultipartFile`, `transferTo()`, UUIDë¡œ íŒŒì¼ëª… ì €ì¥ |
| íŒŒì¼ ì €ì¥ ê²½ë¡œ  | ymlë¡œ ì„¤ì • í›„, `@Value`ë¡œ ì£¼ì…                       |
| ë””ë ‰í† ë¦¬ ìƒì„±   | `@PostConstruct`ë¡œ ìë™ ìƒì„±                       |
| ì •ì  ë¦¬ì†ŒìŠ¤ ì²˜ë¦¬ | `WebMvcConfigurer`ë¡œ URL â†” ë””ë ‰í† ë¦¬ ë§¤í•‘             |
| íŒŒì¼ ê²€ì¦     | MIME íƒ€ì… & íŒŒì¼ í¬ê¸° ì²´í¬                            |
| DB ì—°ê²°     | MariaDB ì„¤ì •ê³¼ yml ì„¸íŒ… ì •ë¦¬                         |

