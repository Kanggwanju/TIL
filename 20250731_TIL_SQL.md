# ðŸ—“ï¸ 2025ë…„ 7ì›” 31ì¼ TIL - SQL ì •ë¦¬


ê³„ì¸µí˜• ì¿¼ë¦¬(Hierarchical Query)

1. ê³„ì¸µí˜• ì¿¼ë¦¬ì˜ í•µì‹¬ 4ì´ì‚¬

`START WITH`
- ê³„ì¸µ íƒìƒ‰ ì‹œìž‘ ì§€ì ì„ ì¡°ê±´ìœ¼ë¡œ ì •í•¨
- START WITHì˜ ì¡°ê±´ì— ë§žëŠ” íŠœí”Œ = LEVEL 1
- LEVEL 1ì€ ë¬´ì¡°ê±´ ë‚˜ì™€ì•¼í•¨

`CONNECT BY`
- ë¶€ëª¨ì™€ ìžì‹ì˜ ê´€ê³„ë¥¼ ì–´ë–»ê²Œ ì—°ê²°í• ì§€ ê·œì¹™ì„ ì •ì˜

`PRIOR`
- ë§ˆì¹˜ `PK`ì²˜ëŸ¼ ë¹ ì§ì—†ì´ ìžˆìœ¼ë©´ ìžì‹
- ì—¬ëŸ¬ê°œì— ì—°ê²°ë˜ì–´ ìžˆìœ¼ë©´ ë¶€ëª¨
- PRIORê°€ ìžì‹ìª½ì— ë¶™ìœ¼ë©´ ìˆœë°©í–¥ ì „ê°œ (ìœ„ -> ì•„ëž˜)
- PRIORê°€ ë¶€ëª¨ìª½ì— ë¶™ìœ¼ë©´ ì—­ë°©í–¥ ì „ê°œ (ì•„ëž˜ -> ìœ„)

`LEVEL`
- ê³„ì¸µì˜ ê¹Šì´(ë‹¨ê³„)ë¥¼ ë‚˜íƒ€ë‚´ëŠ” ê°€ìƒ ì»¬ëŸ¼ (ë£¨íŠ¸ëŠ” 1)


ORDER SIBLINGS BY `ê¸°ì¤€`
- ê³„ì¸µì€ ìœ ì§€í•˜ê³ , í˜•ì œë¼ë¦¬ë§Œ ì •ë ¬

```sql
ORDER SIBLINGS BY -- ORDER BY ëŒ€ì‹  ORDER SIBLINGS BYë¥¼ ì‚¬ìš©!
    registration_date ASC; -- í˜•ì œ ë…¸ë“œ ê°„ ì •ë ¬ ê¸°ì¤€: ê°€ìž…ì¼ ì˜¤ë¦„ì°¨ìˆœ
```

---

ë…¸ëž­ì´ì±… ë¬¸ì œ

ê·¹ížˆ ë“œë¬¸ ì˜ˆì‹œ
SELECT, WHERE ì—ì„œë„ PRIOR í‚¤ì›Œë“œ ì‚¬ìš© ê°€ëŠ¥

ê³„ì¸µí˜• ì§ˆì˜ë¬¸ ì„¤ëª… ê³ ë¥´ê¸°ëŠ” ëŒ€ë¶€ë¶„ ìž¬ê·€


2ê³¼ëª© íŒŒíŠ¸ 3 64ë²ˆ ë¬¸ì œ

â€” ë³´ê¸° 1

ë¶€ì„œì½”ë“œ  ë¶€ì„œëª…   ìƒìœ„ë¶€ì„œì½”ë“œ   LEVEL     ë§¤ì¶œì•¡
===============================
100       ì•„ì‹œì•„ì§€ë¶€   NULL             2        NULL
120       ì¼ë³¸ì§€ì‚¬    100                 1         NULL
121       ë„ì¿„ì§€ì‚¬    120                 2         1500
121       ì˜¤ì‚¬ì¹´ì§€ì‚¬    120               2         1000


â€” ë³´ê¸° 2

ë¶€ì„œì½”ë“œ  ë¶€ì„œëª…   ìƒìœ„ë¶€ì„œì½”ë“œ   LEVEL
===============================
100       ì•„ì‹œì•„ì§€ë¶€     NULL          1
110       í•œêµ­ì§€ì‚¬        100             2
111       ì„œìš¸ì§€ì         110             3
112       ë¶€ì‚°ì§€ì         110             3

120       ì¼ë³¸ì§€ì‚¬        100             2
121       ë„ì¿„ì§€ì         120             3
122       ì˜¤ì‚¬ì¹´ì§€ì         120             3

130       ì¤‘êµ­ì§€ì‚¬        100             2
131       ë² ì´ì§•ì§€ì         130             3
132       ìƒí•˜ì´ì§€ì         130             3


â€” ë³´ê¸° 3

ë¶€ì„œì½”ë“œ  ë¶€ì„œëª…   ìƒìœ„ë¶€ì„œì½”ë“œ   LEVEL
===============================
121       ë„ì¿„ì§€ì         120             1
120       ì¼ë³¸ì§€ì‚¬        100             2
100       ì•„ì‹œì•„ì§€ë¶€      null             3

â€” ë³´ê¸° 4

ë¶€ì„œì½”ë“œ  ë¶€ì„œëª…   ìƒìœ„ë¶€ì„œì½”ë“œ   LEVEL
===============================

100       ì•„ì‹œì•„ì§€ë¶€     NULL          1
110       í•œêµ­ì§€ì‚¬        100             2
111       ì„œìš¸ì§€ì         110             3
112       ë¶€ì‚°ì§€ì         110             3

120       ì¼ë³¸ì§€ì‚¬        100             2
121       ë„ì¿„ì§€ì         120             3
122       ì˜¤ì‚¬ì¹´ì§€ì         120             3

130       ì¤‘êµ­ì§€ì‚¬        100             2
131       ë² ì´ì§•ì§€ì         130             3
132       ìƒí•˜ì´ì§€ì         130             3


---

2ê³¼ëª© íŒŒíŠ¸ 4 74ë²ˆ ë¬¸ì œ

[ í‰ê°€ëŒ€ìƒ ìƒí’ˆ ]
A01    ìŠ¤í”„ë§ë¶€íŠ¸ ê°•ì˜
A02    ë¦¬ì•¡íŠ¸ ê°•ì˜

[ í’ˆì§ˆí‰ê°€ í•­ëª© ]
B01    ê°•ì˜ìžë£Œ
B02    ê°•ì˜ë‚œì´ë„

[ í‰ê°€ ê²°ê³¼ ]
A01   B01     1íšŒì°¨    4.0
A01   B01     2íšŒì°¨    5.0

A01   B02     1íšŒì°¨    1.5
A01   B02     2íšŒì°¨    3.0
A01   B02     3íšŒì°¨    4.0

A02   B01     1íšŒì°¨    4.8

A02   B02     1íšŒì°¨    4.5
A02   B02     2íšŒì°¨    4.7
A02   B02     3íšŒì°¨    2.4

SELECT MAX(X.í‰ê°€íšŒì°¨)
FROM í‰ê°€ê²°ê³¼ X
WHERE X.ìƒí’ˆID = B.ìƒí’ˆID
AND X.í‰ê°€í•­ëª©ID = C.í‰ê°€í•­ëª©ID
-> ìƒí’ˆê³¼ í‰ê°€í•­ëª©ì´ ì¼ì¹˜í•˜ëŠ” íŠœí”Œ ì¡°í•©ë“¤ ì¤‘ì—ì„œ
ê°€ìž¥ ë†’ì€(MAX) í‰ê°€íšŒì°¨ë¥¼ ë½‘ìŒ
-> 2, 3, 1, 3


