# ğŸ—“ï¸ 2025ë…„ 7ì›” 23ì¼ TIL

---

## ğŸ“Œ í•™ìŠµ í‚¤ì›Œë“œ

* JDBC ê¸°ì´ˆ
* `PreparedStatement` ì‚¬ìš©ë²•
* `ResultSet` ì´í•´
* SQL ê¸°ë³¸ ë¬¸ë²•: SELECT / INSERT / UPDATE / DELETE
* ë¦¬ì†ŒìŠ¤ ê´€ë¦¬ & ì˜ˆì™¸ ì²˜ë¦¬

---

## ğŸ” JDBC ê¸°ì´ˆ

### âœ… PreparedStatementë€?

* SQL ì¸ì ì…˜ ë°©ì§€
* ì„±ëŠ¥ í–¥ìƒ
* ì½”ë“œ ê°€ë…ì„±ê³¼ ìœ ì§€ë³´ìˆ˜ì— ë„ì›€

---

## ğŸ§ª PreparedStatement ì‚¬ìš© ì˜ˆì‹œ

### 1ï¸âƒ£ ì¤€ë¹„í•˜ê¸°

```java
String sql = "INSERT INTO users (name, age) VALUES (?, ?)";
PreparedStatement pstmt = connection.prepareStatement(sql);
```

### 2ï¸âƒ£ ê°’ ì„¤ì •

```java
pstmt.setString(1, "í™ê¸¸ë™");  // ì²« ë²ˆì§¸ ? ì— ë¬¸ìì—´ ì„¤ì •
pstmt.setInt(2, 25);          // ë‘ ë²ˆì§¸ ? ì— ìˆ«ì ì„¤ì •
```

### 3ï¸âƒ£ ì‹¤í–‰

```java
pstmt.executeUpdate();  // INSERT, UPDATE, DELETE ì‹¤í–‰
// ë˜ëŠ”
pstmt.executeQuery();   // SELECT ì‹¤í–‰
```

---

## ğŸ“š ë„ì„œ INSERT ì˜ˆì‹œ (save ë©”ì„œë“œ)

```java
public boolean save(Book book) {
    try (Connection conn = dataSource.getConnection()) {

        String sql = """
            INSERT INTO BOOKS (title, author, isbn)
            VALUES (?, ?, ?)
        """;

        PreparedStatement pstmt = conn.prepareStatement(sql);
        pstmt.setString(1, book.getTitle());
        pstmt.setString(2, book.getAuthor());
        pstmt.setString(3, book.getIsbn());

        int result = pstmt.executeUpdate();
        return result == 1;

    } catch (Exception e) {
        e.printStackTrace();
        return false;
    }
}
```

âœ… `try-with-resources`ë¡œ `conn` ìë™ close
âœ… `setString()`ìœ¼ë¡œ ê°ê°ì˜ ê°’ì„ ì„¤ì •
âœ… `executeUpdate()`ë¡œ INSERT ì‹¤í–‰

---

## ğŸ“– ResultSet ì´í•´

```java
ResultSet rs = pstmt.executeQuery();

while (rs.next()) {  // í•œ ì¤„ì”© ì•„ë˜ë¡œ ì´ë™
    String name = rs.getString("name");
    int age = rs.getInt("age");
}
```

---

## ğŸ”„ ë°ì´í„° ì¡°íšŒ ë° ìˆ˜ì •

### ğŸ” SELECT ë¬¸

```java
String sql = "SELECT * FROM books WHERE title LIKE ?";
pstmt.setString(1, "%ìë°”%");
ResultSet rs = pstmt.executeQuery();

while (rs.next()) {
    String title = rs.getString("title");
    System.out.println("ì°¾ì€ ì±…: " + title);
}
```

---

### â• INSERT ë¬¸

```java
String sql = "INSERT INTO books (title, author, isbn) VALUES (?, ?, ?)";
pstmt.setString(1, "ìë°”ì˜ ì •ì„");
pstmt.setString(2, "ë‚¨ê¶ì„±");
pstmt.setString(3, "123456789");
int result = pstmt.executeUpdate();
```

---

### ğŸ“ UPDATE ë¬¸

```java
String sql = "UPDATE books SET available = ? WHERE isbn = ?";
pstmt.setBoolean(1, false);  // ì±…ì´ ëŒ€ì¶œë¨ì„ í‘œì‹œ
pstmt.setString(2, "123456789");
int result = pstmt.executeUpdate();
```

---

### âŒ DELETE ë¬¸

```java
// Hard Delete - ì‹¤ì œ ì‚­ì œ (ê¶Œì¥í•˜ì§€ ì•ŠìŒ)
String sql = "DELETE FROM books WHERE isbn = ?";

// Soft Delete - ë…¼ë¦¬ì  ì‚­ì œ (ê¶Œì¥)
String sql = "UPDATE books SET deleted = true WHERE isbn = ?";
pstmt.setString(1, "123456789");
int result = pstmt.executeUpdate();
```

---

## âš ï¸ ì£¼ì˜ì‚¬í•­ ì •ë¦¬

1. **ë¦¬ì†ŒìŠ¤ ê´€ë¦¬**

    * `ResultSet`, `PreparedStatement`, `Connection`ì€ ë°˜ë“œì‹œ ë‹«ì•„ì•¼ í•¨
    * `try-with-resources` ì‚¬ìš© ì‹œ ìë™ìœ¼ë¡œ close

2. **ë°ì´í„° íƒ€ì… ë§¤ì¹­**

    * DBì˜ ì»¬ëŸ¼ íƒ€ì…ê³¼ Java íƒ€ì…ì„ ì •í™•íˆ ë§ì¶°ì•¼ í•¨
      ì˜ˆ: `NUMBER` â†” `Long` ë˜ëŠ” `Integer`

3. **ì˜ˆì™¸ ì²˜ë¦¬**

    * ëª¨ë“  SQL ì‘ì—…ì€ ì‹¤íŒ¨ ê°€ëŠ¥ì„±ì´ ìˆìœ¼ë¯€ë¡œ `try-catch` ì²˜ë¦¬ í•„ìˆ˜

4. **ì„±ëŠ¥ ê³ ë ¤**

    * ëŒ€ìš©ëŸ‰ ì¡°íšŒ ì‹œ ì „ë¶€ ë©”ëª¨ë¦¬ì— ì˜¬ë¦¬ì§€ ì•Šë„ë¡ ì£¼ì˜ (í˜ì´ì§• ë“± ê³ ë ¤)

---

## âœ… ì˜¤ëŠ˜ì˜ ìš”ì•½

* `PreparedStatement`ëŠ” ë³´ì•ˆê³¼ ìœ ì§€ë³´ìˆ˜ë¥¼ ê³ ë ¤í•œ í•„ìˆ˜ ë„êµ¬
* `executeUpdate()`ëŠ” ì‚½ì…, ìˆ˜ì •, ì‚­ì œì—ì„œ ì‚¬ìš©
* `ResultSet`ì€ `SELECT` ê²°ê³¼ ë°˜ë³µ ì²˜ë¦¬ì— ì‚¬ìš©ë¨
* SQL ì‘ì—… ì‹œ ë¦¬ì†ŒìŠ¤ ê´€ë¦¬ì™€ ì˜ˆì™¸ ì²˜ë¦¬ ê¼­ ì‹ ê²½ì“°ê¸°!
