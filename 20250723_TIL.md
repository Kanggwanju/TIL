# ðŸ—“ï¸ 2025ë…„ 7ì›” 23ì¼ TIL


JDBC ê¸°ì´ˆ
PreparedStatement
- SQL ì¸ì ì…˜ ë°©ì§€
- ì„±ëŠ¥ í–¥ìƒ
- ì½”ë“œ ê°€ë…ì„±ê³¼ ìœ ì§€ë³´ìˆ˜

ì‚¬ìš© ë°©ë²•
1. ì¤€ë¹„í•˜ê¸°
```java
String sql = "INSERT INTO users (name, age) VALUES (?, ?)";
PreparedStatement pstmt = connection.prepareStatement(sql);
```
2. ê°’ ì„¤ì •
```java
pstmt.setString(1, "í™ê¸¸ë™");  // ì²« ë²ˆì§¸ ? ì— ë¬¸ìžì—´ ì„¤ì •
pstmt.setInt(2, 25);        // ë‘ ë²ˆì§¸ ? ì— ìˆ«ìž ì„¤ì •
```
3. ì‹¤í–‰í•˜ê¸°
```java
pstmt.executeUpdate();  // INSERT, UPDATE, DELETE ì‹¤í–‰í•  ë•Œ
// ë˜ëŠ”
pstmt.executeQuery();   // SELECT ì‹¤í–‰í•  ë•Œ
```
ì˜ˆì‹œ) INSERT ê¸°ëŠ¥ - ë„ì„œ ìƒì„±
```java
public boolean save(Book book) {
    try (Connection conn = dataSource.getConnection()) {

        String sql = """
                    INSERT INTO BOOKS
                        (title, author, isbn)
                    VALUES
                        (?, ?, ?)
                    """;

        PreparedStatement pstmt = conn.prepareStatement(sql);
        pstmt.setString(1, book.getTitle());
        pstmt.setString(2, book.getAuthor());
        pstmt.setString(3, book.getIsbn());

        int result = pstmt.executeUpdate();
        return result == 1;


    } catch (Exception e) {
        e.printStackTrace();
        return false;
    }
}

```
---
- tryì— íŒŒë¼ë¯¸í„°ë¡œ connì„ ë„£ì–´ì¤Œìœ¼ë¡œì¨ ë‚˜ì¤‘ì— closeë¥¼ í•˜ì§€ ì•Šì•„ë„
  ë˜ê²Œ ë§Œë“¤ìŒ.
- sqlë¬¸ì„ ë”°ë¡œ ì„¤ì •í•˜ê³  prepareStatementë¥¼ ë§Œë“¤ì–´ì„œ ì¤€ë¹„
- setStringì„ í†µí•´ ì œëª©, ì €ìž, ISBNì„ ì„¤ì •
- executeUpdateì„ ì´ìš©í•˜ì—¬ INSERT ë¬¸ ì‹¤í–‰


---

ResultSet ì´í•´
```java
ResultSet rs = pstmt.executeQuery();
while (rs.next()) {  // í•œ ì¤„ì”© ì•„ëž˜ë¡œ ì´ë™
    String name = rs.getString("name");  // name ì»¬ëŸ¼ì˜ ê°’ì„ ì½ê¸°
    int age = rs.getInt("age");         // age ì»¬ëŸ¼ì˜ ê°’ì„ ì½ê¸°
}

```


ë°ì´í„° ì¡°íšŒì™€ ìˆ˜ì •
(SELECT, INSERT, UPDATE, DELETE)

SELECT ë¬¸ - ë°ì´í„° ì¡°íšŒ

```java
String sql = "SELECT * FROM books WHERE title LIKE ?";
pstmt.setString(1, "%ìžë°”%");
ResultSet rs = pstmt.executeQuery();

while (rs.next()) {
    String title = rs.getString("title");
    System.out.println("ì°¾ì€ ì±…: " + title);
}

```

INSERT ë¬¸ - ìƒˆë¡œìš´ ë°ì´í„° ì¶”ê°€
```java
String sql = "INSERT INTO books (title, author, isbn) VALUES (?, ?, ?)";
pstmt.setString(1, "ìžë°”ì˜ ì •ì„");
pstmt.setString(2, "ë‚¨ê¶ì„±");
pstmt.setString(3, "123456789");
int result = pstmt.executeUpdate();

```

UPDATE ë¬¸ - ê¸°ì¡´ ë°ì´í„° ìˆ˜ì •
```java
String sql = "UPDATE books SET available = ? WHERE isbn = ?";
pstmt.setBoolean(1, false);  // ì±…ì´ ëŒ€ì¶œë¨ì„ í‘œì‹œ
pstmt.setString(2, "123456789");
int result = pstmt.executeUpdate();

```

DELETE ë¬¸ - ë°ì´í„° ì‚­ì œ
```java
// Hard Delete (ì‹¤ì œ ì‚­ì œ) - ê¶Œìž¥í•˜ì§€ ì•ŠìŒ
String sql = "DELETE FROM books WHERE isbn = ?";

// Soft Delete (ë…¼ë¦¬ì  ì‚­ì œ) - ê¶Œìž¥
String sql = "UPDATE books SET deleted = true WHERE isbn = ?";
pstmt.setString(1, "123456789");
int result = pstmt.executeUpdate();

```

ì£¼ì˜í•  ì 

1. ë¦¬ì†ŒìŠ¤ ê´€ë¦¬
- ResultSet, PreparedStatement, Connectionì€ 
- ë°˜ë“œì‹œ ì‚¬ìš© í›„ ë‹«ì•„ì£¼ì–´ì•¼ í•¨. try-with-resources êµ¬ë¬¸ì„ ì‚¬ìš©í•˜ë©´ ìžë™ìœ¼ë¡œ ì²˜ë¦¬
2. ë°ì´í„° íƒ€ìž… ë§¤ì¹­
- ë°ì´í„°ë² ì´ìŠ¤ì˜ ì»¬ëŸ¼ íƒ€ìž…ê³¼ ìžë°”ì˜ ë°ì´í„° íƒ€ìž…ì„ ì˜¬ë°”ë¥´ê²Œ ë§¤ì¹­
- ë°ì´í„°ë² ì´ìŠ¤ì˜ NUMBERëŠ” ìžë°”ì˜ Longì´ë‚˜ Integerì™€ ë§¤ì¹­
3. ì˜ˆì™¸ì²˜ë¦¬
- SQL ìž‘ì—…ì€ í•­ìƒ ì‹¤íŒ¨í•  ê°€ëŠ¥ì„±ì´ ìžˆìœ¼ë¯€ë¡œ, ì ì ˆí•œ ì˜ˆì™¸ ì²˜ë¦¬ê°€ í•„ìš”
4. ì„±ëŠ¥ ê³ ë ¤
- ëŒ€ëŸ‰ì˜ ë°ì´í„°ë¥¼ ë‹¤ë£° ë•ŒëŠ” í•œ ë²ˆì— ëª¨ë“  ë°ì´í„°ë¥¼ ë©”ëª¨ë¦¬ì— ë¶ˆëŸ¬ì˜¤ì§€ ì•Šë„ë¡ ì£¼ì˜






































SQL ê¸°ë³¸
5ê°• - GROUP BY, HAVING ì ˆ


WHERE ì ˆì€ ê·¸ë£¹í™”í•˜ê¸° ì „, ì§‘ê³„ ëŒ€ìƒì´ ë˜ê¸° ì „ì— ë¹¼ë²„ë¦¼
HAVING ì ˆì€ ê·¸ë£¹í™”í•˜ê³  ë‚œ í›„ í•„í„°ë§

 
1. FROM: íƒ€ê²ŸíŒ…
2. WHERE: 1ì°¨ í•„í„°ë§
3. GROUP BY: ì§‘ê³„
4. HAVING: 2ì°¨ í•„í„°
5. SELECT: ë§¤í•‘
6. ORDER BY: ì •ë ¬

```sql
-- POST í…Œì´ë¸”ì—ì„œ ìž¥ë¬¸(20ê¸€ìžì´ìƒ)ì˜ í”¼ë“œë¥¼ ì“´ ê²Œì‹œë¬¼ë“¤ì˜ ê°œìˆ˜ë¥¼ ë³´ê³  ì‹¶ë‹¤.
-- ìœ ì €ë³„ë¡œ ë³´ê³ ì‹¶ìŒ
-- ìž¥ë¬¸ ê²Œì‹œë¬¼ 5ê°œ ì´ìƒ ì“´ ì•„ì´ë””
SELECT
    user_id,
    COUNT(*) AS "ìž¥ë¬¸ ê²Œì‹œë¬¼ ìˆ˜"
FROM
    POSTS
WHERE LENGTH(content) >= 30
GROUP BY user_id
HAVING COUNT(*) >= 5 -- ìž¥ë¬¸ ê²Œì‹œë¬¼ì„ ì“´ ì‚¬ìš©ìžë§Œ ì¡°íšŒ
;
```




ì¤‘ìš”!
nullì— ì–´ë–¤ ì—°ì‚°ì„ í•´ë„ nullì´ ë‚˜ì˜¨ë‹¤.
ex) null + 20 -> null, null*3 -> null
