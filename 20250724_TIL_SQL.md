# 🗓️ 2025년 7월 24일 TIL - SQL 정리

ORDER BY 절

결과 정렬하기 (Part 1. ORDER BY 기본)
- 추출된 데이터의 순서를 깔끔하게 정리해주는 명령어
- SQL 쿼리의 가장 마지막에 위치해서, 최종 결과를 우리가 원하는 기준에 맞춰 정렬


1. 오름차순 정렬: `ASC` (Ascending)
- 가장 작은 값부터 큰 값 순서로 정렬하는 방식
- **숫자**: 1, 2, 3, ...
- **문자**: A, B, C, ... (가나다순)
- **날짜**: 과거부터 현재 순
- 아무것도 지정하지 않으면, 이 오름차순(ASC)이 기본값으로 적용

```sql
-- registration_date를 기준으로 오름차순 정렬합니다.
-- ASC는 기본값이므로 생략할 수 있습니다.
SELECT
    username,
    registration_date
FROM
        USERS
ORDER BY
    registration_date ASC -- 또는 registration_date; 라고만 써도 동일하게 동작
; 
```

2. 내림차순 정렬: `DESC` (Descending)
- 가장 큰 값부터 작은 값 순서로 정렬
```sql
-- creation_date를 기준으로 내림차순 정렬합니다.
SELECT
    post_id,
    user_id,
    content,
    creation_date
FROM
    POSTS
ORDER BY
    creation_date DESC;
```

3. 여러 기준으로 정렬
```sql
-- 1차: post_type 오름차순, 2차: creation_date 내림차순으로 정렬
SELECT
    post_id,
    post_type,
    creation_date
FROM
    POSTS
ORDER BY
    post_type ASC         -- 1차 정렬 기준 (ASC는 생략 가능)
    , creation_date DESC  -- 2차 정렬 기준
;
```

결과 정렬하기 (Part 2. ORDER BY 고급)

4. 컬럼 위치 번호, 별명(Alias)으로 정렬 가능
```sql
SELECT
  USERNAME AS UNAME,  -- 1번
  REGISTRATION_DATE   -- 2번
FROM USERS
ORDER BY UNAME DESC, 2 ASC
-- 1차 정렬 기준이 이름임, 동명이인이 있을 경우에만 유의미하게 적용됨.
;
```

5. ORDER BY 절에 집계함수 사용 가능
```sql
-- 5강에서 배운 GROUP BY를 활용해 사용자별 게시물 수를 구하고,
-- 그 결과(별명: post_count)를 기준으로 내림차순 정렬합니다.
SELECT
    user_id,
    COUNT(*) AS post_count
FROM
    POSTS
GROUP BY
    user_id
-- 오더바이 절에 집계 함수 사용 가능, 별칭으로도 가능
ORDER BY COUNT(*) DESC, USER_ID DESC
;
```

6. `CASE` 표현식으로 내 마음대로 정렬하기
```sql
-- user_id가 1이면 1순위, 나머지는 2순위로 정렬 우선순위를 부여하고,
-- 같은 순위 내에서는 creation_date를 기준으로 내림차순 정렬합니다.
SELECT
    post_id,
    user_id,
    content,
    creation_date
FROM
    POSTS
ORDER BY
    CASE
        WHEN user_id = 21 THEN 1 -- user_id가 1이면 1순위
        ELSE 2                   -- 나머지는 2순위
    END ASC, -- 1차 정렬 기준: CASE 표현식
    creation_date DESC -- 2차 정렬 기준: 작성일
;
```
- user-id = 21이면 1으로 치환해서 생각하고, 나머지는 2로 치환해서 생각하는거라 보면 됨.
- 아이디가 21이면 위쪽, 나머지는 아래쪽에 있고, 작성일 기준으로 2차 정렬을 함.
- 2차 정렬을 하지 않았더라면 아이디가 21인 행이 위쪽, 나머지는 아래쪽에 순번대로 정렬된다. 
























