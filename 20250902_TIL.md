# ğŸ—“ï¸ 2025ë…„ 9ì›” 2ì¼ TIL


## **í‚¤ì›Œë“œ ìš”ì•½**

* **React Router:** `action` í•¨ìˆ˜, `loader` í•¨ìˆ˜, `Form` ì»´í¬ë„ŒíŠ¸, `useSubmit` í›…
* **Spring Boot:** QueryDSL, `Slice` ê°ì²´, ë¬´í•œìŠ¤í¬ë¡¤ êµ¬í˜„

---

## **1. React Router `action` í•¨ìˆ˜**

* **ì •ì˜**: í¼ ì œì¶œì´ë‚˜ ë°ì´í„° ë³€ê²½(`CUD`)ì„ ì²˜ë¦¬í•˜ëŠ” í•¨ìˆ˜
* **ì—­í• **: í¼ì„ ì œì¶œí•  ë•Œ React Routerê°€ í¼ ë°ì´í„°ë¥¼ ìë™ìœ¼ë¡œ ê°€ë¡œì±„ì„œ ì „ë‹¬
* **`loader` vs `action`**: `loader`ëŠ” ë°ì´í„° ì½ê¸°(`GET`), `action`ì€ ë°ì´í„° ë³€ê²½(`CUD`)

### **ì£¼ìš” íŒŒë¼ë¯¸í„°**

* `request`: í¼ì— ì…ë ¥ëœ ë°ì´í„°, **HTTP ë©”ì„œë“œ** ë“± ìš”ì²­ì— ëŒ€í•œ ì •ë³´ë¥¼ ë‹´ëŠ” ê°ì²´
* `params`: URL ì£¼ì†Œì˜ ë™ì  ì„¸ê·¸ë¨¼íŠ¸(ì˜ˆ: `/:postId`) ê°’ì„ ë‹´ëŠ” ê°ì²´

### **ë¼ìš°í„° ì„¤ì • (`route-config.jsx`)**

* `new` ê²½ë¡œì— `NewEventPage` ì»´í¬ë„ŒíŠ¸ë¥¼ ì—°ê²°í•˜ê³ , í¼ ì œì¶œ ì‹œ ì‹¤í–‰í•  `saveAction` í•¨ìˆ˜ë¥¼ `action` ì†ì„±ì— ì§€ì •
  ```jsx
  const router = createBrowserRouter([
    {
      path: 'new',
      element: <NewEventPage />,
      action: saveAction
    }
  ]);
  ```

---

### **`action` í•¨ìˆ˜ (`events-actions.js`)**

* `redirect` í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•´ì„œ ë°ì´í„° ì²˜ë¦¬ í›„ í˜ì´ì§€ë¥¼ ì „í™˜
* `request.formData()`: í¼ì— ì…ë ¥í•œ ê°’ ê°€ì ¸ì˜¤ê¸°
* `request.method`: ì–´ë–¤ ìš”ì²­ì„ í–ˆëŠ”ì§€
* `redirect()`: React Routerê°€ ì œê³µí•˜ë©°, `action` ë˜ëŠ” `loader` í•¨ìˆ˜ ë‚´ì—ì„œ `return`í•˜ë©´ ì›í•˜ëŠ” í˜ì´ì§€ë¡œ ì´ë™
  ```jsx
  import {redirect} from 'react-router-dom';

  export const saveAction = async ({ request }) => {
    const formData = await request.formData();
    const payload = { ... };

    const response = await fetch('http://localhost:9000/api/events', {
      method: request.method,
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify(payload)
    });

    if (!response.ok) {
      throw new Error('ì´ë²¤íŠ¸ ìƒì„±ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.');
    }

    return redirect('/events');
  };
  ```

---

### **í¼ ì»´í¬ë„ŒíŠ¸ (`EventForm.jsx`)**

* `Form` ì»´í¬ë„ŒíŠ¸: React Routerê°€ ì œê³µí•˜ë©°, `action` í•¨ìˆ˜ë¥¼ íŠ¸ë¦¬ê±°í•˜ê¸° ìœ„í•´ ì‚¬ìš©
* `method` ì†ì„±: í•„ìˆ˜ ì†ì„±ìœ¼ë¡œ HTTP ë©”ì„œë“œ ì§€ì •
* **ë²„íŠ¼ì˜ `type`**:
    * `Save` ë²„íŠ¼ì²˜ëŸ¼ `type`ì„ ëª…ì‹œí•˜ì§€ ì•Šìœ¼ë©´ ê¸°ë³¸ê°’ì€ `submit`ì´ ë˜ì–´ í¼ ì œì¶œ ë°œìƒ
    * `Cancel` ë²„íŠ¼ì²˜ëŸ¼ `type="button"`ìœ¼ë¡œ ëª…ì‹œí•˜ë©´ í¼ ì œì¶œì´ ë°©ì§€ë¨
      ```jsx
      <Form
        method='POST'
        className={styles.form}
        noValidate
      >
        <p>
          <label htmlFor='title'>Title</label>
          <input id='title' type='text' name='title' required />
        </p>
        <div className={styles.actions}>
          <button type='button'>Cancel</button>
          <button>Save</button>
        </div>
      </Form>
      ```

---

### **`useSubmit` í›…**

* `Form` ì»´í¬ë„ŒíŠ¸ ì—†ì´ `action` í•¨ìˆ˜ë¥¼ ì‘ë™ì‹œí‚¤ëŠ” ë°©ë²•
* ì£¼ë¡œ \*\*ë‚™ê´€ì  ì—…ë°ì´íŠ¸(Optimistic UI)\*\*ë¥¼ êµ¬í˜„í•  ë•Œ ì‚¬ìš©
* ì‚¬ìš©ìì˜ ì•¡ì…˜ì— ëŒ€í•œ ì„œë²„ ì‘ë‹µì„ ê¸°ë‹¤ë¦¬ì§€ ì•Šê³  ë¯¸ë¦¬ UIë¥¼ ì—…ë°ì´íŠ¸í•˜ëŠ” ë°©ì‹
* `submit(null, { method: 'DELETE' })`: `submit` í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•˜ì—¬ `action`ì„ íŠ¸ë¦¬ê±°
    * ì²« ë²ˆì§¸ íŒŒë¼ë¯¸í„°: í¼ ë°ì´í„°. í•„ìš” ì—†ì„ ê²½ìš° `null`
    * ë‘ ë²ˆì§¸ íŒŒë¼ë¯¸í„°: ìš”ì²­ ì •ë³´

  ```jsx
  const submit = useSubmit();

  const deleteHandler = e => {
    submit(null, { method: 'DELETE' });
  };

  return (
    <article className={styles.event}>
      <menu className={styles.actions}>
        <Link to='edit'>Edit</Link>
        <button onClick={deleteHandler}>Delete</button>
      </menu>
    </article>
  );
  ```

---

## **2. Spring Boot QueryDSL ë¬´í•œìŠ¤í¬ë¡¤**

* **ì •ì˜**: `Slice`ë¥¼ ì´ìš©í•´ ë°±ì—”ë“œì—ì„œ ë¬´í•œìŠ¤í¬ë¡¤ì„ êµ¬í˜„í•˜ëŠ” ë¡œì§
* **`Slice`**: `Page`ì™€ ë‹¤ë¥´ê²Œ ì „ì²´ ë°ì´í„°ì˜ ì´ ê°œìˆ˜ë¥¼ ì•Œ í•„ìš” ì—†ì´, ë‹¤ìŒ í˜ì´ì§€ ì¡´ì¬ ì—¬ë¶€ë§Œ íŒë‹¨

### **í•µì‹¬ ì›ë¦¬**

* ì„œë²„ëŠ” ì‹¤ì œë¡œ ê°€ì ¸ê°ˆ ë°ì´í„°ë³´ë‹¤ **1ê°œ ë” ì¡°íšŒ**í•˜ì—¬ ë°ì´í„°ì˜ ëì„ í™•ì¸
* `hasNext`: ë‹¤ìŒ ë°ì´í„°ê°€ ìˆëŠ”ì§€ ì—¬ë¶€ë¥¼ ë‚˜íƒ€ë‚´ëŠ” boolean ê°’

### **ì½”ë“œ ë¶„ì„ (`EventRepositoryImpl.java`)**

* `limit(pageable.getPageSize() + 1)`: ìš”ì²­ëœ í˜ì´ì§€ í¬ê¸°ë³´ë‹¤ 1ê°œ ë” ì¡°íšŒ
* `if (eventList.size() > pageable.getPageSize())`: ì¡°íšŒëœ ë°ì´í„°ê°€ ìš”ì²­ ê°œìˆ˜ë³´ë‹¤ ë§ìœ¼ë©´ `hasNext`ë¥¼ `true`ë¡œ ì„¤ì •
* `eventList.remove(eventList.size() - 1)`: ì‹¤ì œ ë°˜í™˜í•  ë°ì´í„°ì—ì„œ ë¶ˆí•„ìš”í•œ ë§ˆì§€ë§‰ í•­ëª©ì€ ì œê±°
* `return new SliceImpl<>(eventList, pageable, hasNext)`: `Slice` ê°ì²´ ë°˜í™˜


```java
public class EventRepositoryImpl implements EventRepositoryCustom {

    private final JPAQueryFactory factory;

    @Override
    public Slice<Event> findEvents(Pageable pageable) {
        List<Event> eventList = factory
                .selectFrom(event)
                .orderBy(event.createdAt.desc())
                .offset(pageable.getOffset())
                .limit(pageable.getPageSize() + 1)
                .fetch();

        boolean hasNext = false;

        if (eventList.size() > pageable.getPageSize()) {
            hasNext = true;
            eventList.remove(eventList.size() - 1);
        }

        return new SliceImpl<>(eventList, pageable, hasNext);
    }
}
```
---

## âœ… ìµœì¢… ì •ë¦¬
- React Routerì˜ `action` í•¨ìˆ˜: í¼ ì œì¶œ ì‹œ ì„ ì–¸ì ìœ¼ë¡œ ë°ì´í„°ë¥¼ ë³€ê²½(CUD)í•˜ëŠ” ë°©ì‹
- `useSubmit` í›…: `Form` ì—†ì´ `action`ì„ í˜¸ì¶œí•´ ë‚™ê´€ì  ì—…ë°ì´íŠ¸ êµ¬í˜„ì— í™œìš©
- Spring Boot `Slice`: ë¬´í•œìŠ¤í¬ë¡¤ êµ¬í˜„ ì‹œ ì „ì²´ ê°œìˆ˜ ì—†ì´ ë‹¤ìŒ í˜ì´ì§€ ì¡´ì¬ ì—¬ë¶€ë§Œ í™•ì¸í•˜ì—¬ ì„±ëŠ¥ ìµœì í™”

