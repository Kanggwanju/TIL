# ğŸ—“ï¸ 2025ë…„ 7ì›” 16ì¼ TIL

ë¡œê·¸, ë°ì´í„° ê²€ì¦, Request DTO(Data Transfer Object), ì…ë ¥ê°’ ê²€ì¦(@Valid) 
,íŒ©í† ë¦¬ ë©”ì„œë“œ íŒ¨í„´ê³¼ ì—ëŸ¬ ë©”ì‹œì§€ ì»¤ìŠ¤í…€ ë°©ë²•
,Response DTOì™€ ì‘ë‹µ Jsonì²˜ë¦¬



ë¡œê·¸ì˜ ê¸°ë³¸ ìš”ì†Œ - ê°ì‚¬, ëª¨ë‹ˆí„°ë§, ì¬í•´ë³µêµ¬
1. ë¡œê·¸ ë‚´ìš©
2. ë¡œê·¸ ë ˆë²¨ - ì¤‘ìš”ë„
- TRACE : ë‹¨ìˆœíˆ ê°ì²´ê°€ ìƒì„±ë˜ê±°ë‚˜, í•¨ìˆ˜ê°€ í˜¸ì¶œë˜ê±°ë‚˜ í•˜ëŠ” ë¡œê·¸ë¥¼ ì°ì„ ë•Œ
- DEBUG : ê°œë°œí•˜ë©´ì„œ ë³€ìˆ˜ê°’ì„ ì¶”ì í•˜ê±°ë‚˜ ë””ë²„ê¹… ìš©ë„
- INFO : ìš´ì˜ì„œë²„ì˜ ì¼ë°˜ì ì¸ ë‚´ìš©ì„ ì‘ì„± (ì„œë²„ê°€ ì‹¤í–‰, íŠ¹ì • í•µì‹¬ ìš”ì²­ì´ ë“¤ì–´ì˜¤ê±°ë‚˜)
- WARN : ë­”ê°€ ì´ìƒì´ ìƒê¸´ ê²½ìš°, ë‹¤ë§Œ í”„ë¡œê·¸ë¨ì— í° ìœ„í•´ëŠ” ì•„ë‹Œ ê²½ìš°
- ERROR : ì»¤ë‹¤ë€ ì˜ˆì™¸ê°€ ë°œìƒí•˜ê±°ë‚˜ í”„ë¡œê·¸ë¨ì— ì¹˜ëª…ì ì¸ ì˜¤ë¥˜ê°€ ë‚œ ê²½ìš°
- FATAL : ì‹œìŠ¤í…œ ì¥ì• 

3. ë¡œê·¸ê°€ ì°íŒ ì‹œê°„
4. ë¡œê·¸ê°€ ì°íŒ ìœ„ì¹˜ (íŒŒì¼ ê²½ë¡œ)

application.propertiesì—ì„œ logging.level.root=ë¡œê·¸ë ˆë²¨
ì„ í•´ì£¼ë©´ ì„¤ì •í•œ ë¡œê·¸ ë ˆë²¨ ì´ìƒì˜ ë¡œê·¸ë“¤ì´ ë³´ì„.

ìš°ë¦¬ í”„ë¡œì íŠ¸ëŠ” DEBUGë¡œ ì„¤ì •, ì‹¤ë¬´ì—ì„œëŠ” ê±°ì˜ DEBUG ì´ìƒì˜
ë¡œê·¸ë§Œ ì”€.
logging.level.com.spring.basic=DEBUG

ë°°í¬ì„œë²„ì—ì„œëŠ” INFOë¡œ ë³€ê²½
ë°°í¬ì„œë²„ì—ì„œ ë¡œê·¸ ë ˆë²¨ì„ INFOë¡œ ì„¤ì •í•˜ëŠ” ì´ìœ ëŠ” 
ìš´ì˜ í™˜ê²½ì—ì„œì˜ ì•ˆì •ì„±ê³¼ ì„±ëŠ¥ ìµœì í™” ë•Œë¬¸

ì»¨íŠ¸ë¡¤ëŸ¬ì— ë¡œê·¸ ë¼ì´ë¸ŒëŸ¬ë¦¬ì¸ @Slf4jì„ ì¶”ê°€í•´ì¤˜ì•¼í•¨
```java
// ì „ì²´ ì¡°íšŒ
@GetMapping
public ResponseEntity<?> memberList() {
    log.trace("memberList ë©”ì„œë“œ í˜¸ì¶œë¨");

    log.info("/api/v5-3/members : GET - ìš”ì²­ ì‹œì‘!");

    List<Member> members = new ArrayList<>(memberStore.values());

    log.debug("member.size = {}", members.size());

    if (members.size() <= 0) {
        log.warn("íšŒì› ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤.");
        return ResponseEntity.notFound().build();
    }

    log.debug("members[0].nickname = {}", members.get(0).getNickname());

    try {

    } catch (Exception e) {
        log.error("ì„œë²„ ì—ëŸ¬ì…ë‹ˆë‹¤.");
        return ResponseEntity.internalServerError().body("ì„œë²„ ì—ëŸ¬ì…ë‹ˆë‹¤.");
    }

    log.trace("memberList ë©”ì„œë“œ í˜¸ì¶œ ì¢…ë£Œë¨");
    return ResponseEntity
        .ok()
        .body(members);
}
```
---

ë°ì´í„° ê²€ì¦ê³¼ Request DTO(Data Transfer Object)

# ğŸ“¦ DTO(Data Transfer Object)ë€?

**DTO**ëŠ” "Data Transfer Object"ì˜ ì•½ìë¡œ,
**ê³„ì¸µ ê°„(ì˜ˆ: Controller â†” Service â†” Repository â†” Frontend) ë°ì´í„°ë¥¼ ì£¼ê³ ë°›ê¸° ìœ„í•œ ê°ì²´**

ì‰½ê²Œ ë§í•˜ë©´,
ğŸ‘‰ **ë°ì´í„°ë¥¼ ì „ë‹¬í•˜ê¸° ìœ„í•œ ì „ìš© ìƒì**

---

## âœ… ì™œ DTOë¥¼ ì‚¬ìš©í• ê¹Œ? (ì‚¬ìš© ëª©ì )

### 1. **Entity(ë„ë©”ì¸ ê°ì²´)ë¥¼ ì§ì ‘ ë…¸ì¶œí•˜ì§€ ì•Šê¸° ìœ„í•´**

* `Entity`ëŠ” DBì™€ ì—°ê²°ëœ ì¤‘ìš”í•œ ë¹„ì¦ˆë‹ˆìŠ¤ ê°ì²´ì„
* ì§ì ‘ ë…¸ì¶œí•˜ë©´ ë³´ì•ˆ ë¬¸ì œ, ë³€ê²½ ë¶ˆê°€, ìœ ì—°ì„± ì €í•˜ ë“±ì˜ ë¬¸ì œê°€ ë°œìƒí•¨
* ê·¸ë˜ì„œ **DTOë¥¼ í†µí•´ í•„ìš”í•œ ì •ë³´ë§Œ ì „ë‹¬**í•˜ëŠ” ê²Œ ì•ˆì „í•¨

---

### 2. **í•„ìš”í•œ ë°ì´í„°ë§Œ ì „ë‹¬í•˜ê¸° ìœ„í•´**

* ì˜ˆ: `User` ì—”í‹°í‹°ì—ëŠ” ì´ë¦„, ë¹„ë°€ë²ˆí˜¸, ì£¼ì†Œ, ìƒì¼ ë“± ëª¨ë“  ì •ë³´ê°€ ìˆì§€ë§Œ,
* ì‚¬ìš©ì ëª©ë¡ ì¡°íšŒ ì‹œì—ëŠ” ì´ë¦„, ìƒì¼ë§Œ í•„ìš”í•  ìˆ˜ë„ ìˆìŒ
* DTOë¥¼ ì‚¬ìš©í•˜ë©´ **í•„ìš”í•œ ë°ì´í„°ë§Œ ê³¨ë¼ì„œ ë‹´ì•„ ì‘ë‹µ**í•  ìˆ˜ ìˆìŒ

    * â†’ ë„¤íŠ¸ì›Œí¬ íš¨ìœ¨ í–¥ìƒ
    * â†’ ë¯¼ê°í•œ ì •ë³´ ë³´í˜¸

---

### 3. **í”„ë¡ íŠ¸ì—”ë“œì™€ í•„ë“œëª…ì´ ë‹¤ë¥¼ ê²½ìš° ëŒ€ì‘í•˜ê¸° ìœ„í•´**

* í”„ë¡ íŠ¸ì—ì„œëŠ” `pwd`, ë°±ì—”ë“œëŠ” `password`ë¥¼ ì‚¬ìš©í•˜ê³  ìˆì„ ìˆ˜ ìˆìŒ.

```json
// í”„ë¡ íŠ¸ ìš”ì²­ ì˜ˆì‹œ
{
  "id": "panju123",
  "pwd": "1234"
}
```

```java
// DTOì—ì„œ í•„ë“œëª…ì„ ë‹¤ë¥´ê²Œ ì„¤ì •
public class UserRequestDTO {
    private String id;

    @JsonProperty("pwd") // JSONì˜ pwd â†’ Javaì˜ passwordë¡œ ë§¤í•‘
    private String password;
}
```

* DTOì—ì„œëŠ” `@JsonProperty`ë¥¼ í†µí•´ ì´ë¦„ì´ ë‹¬ë¼ë„ **ììœ ë¡­ê²Œ ë§¤í•‘ ê°€ëŠ¥**
* ì¦‰, **í”„ë¡ íŠ¸ì™€ í˜‘ì—… ì‹œ ìœ ì—°í•œ í•„ë“œ ì²˜ë¦¬**ê°€ ê°€ëŠ¥

---

### 4. **ì…ë ¥ê°’ ê²€ì¦ì— ì‚¬ìš©í•˜ê¸° ìœ„í•´**

* DTOëŠ” ì‚¬ìš©ìì˜ ì…ë ¥ ê°’ì„ ê²€ì¦í•˜ëŠ” ë°ë„ ìœ ìš©

```java
public class UserRequestDTO {

    @NotBlank
    private String username;

    @Email
    private String email;

    @Size(min = 8)
    private String password;
}
```

* `@Valid` ì–´ë…¸í…Œì´ì…˜ê³¼ í•¨ê»˜ ì“°ë©´, ì»¨íŠ¸ë¡¤ëŸ¬ ë‹¨ì—ì„œ ìë™ìœ¼ë¡œ ê²€ì¦ì´ ê°€ëŠ¥

---

### 5. **ê³„ì¸µ ê°„ ì˜ì¡´ì„±ì„ ì¤„ì´ê¸° ìœ„í•´**

* Entityë¥¼ ì§ì ‘ ì»¨íŠ¸ë¡¤ëŸ¬ì— ì „ë‹¬í•˜ê±°ë‚˜ ë°˜í™˜í•˜ê²Œ ë˜ë©´,
  êµ¬ì¡°ê°€ ë°”ë€” ë•Œ **ì „ì²´ ì½”ë“œì— ì˜í–¥ì„ ì£¼ê²Œ ë¼ìš”**.
* DTOë¥¼ ì¤‘ê°„ ê³„ì¸µì—ì„œ ì‚¬ìš©í•˜ë©´, **ê° ê³„ì¸µì´ ëŠìŠ¨í•˜ê²Œ ì—°ê²°ë˜ì–´ ìœ ì—°ì„±**ì´ ìƒê¹€.

---

## ğŸ¯ ì‹¤ìƒí™œ ë¹„ìœ 

> íƒë°°ë¥¼ ë³´ë‚¼ ë•Œ, ì§‘ ì•ˆì˜ ë¬¼ê±´ì„ ê·¸ëŒ€ë¡œ ë³´ë‚´ì§€ ì•Šê³ 
> **í•„ìš”í•œ ë¬¼ê±´ë§Œ ì•ˆì „í•˜ê²Œ í¬ì¥í•´ì„œ ë°•ìŠ¤ì— ë‹´ì•„ ë³´ë‚´ëŠ” ê²ƒ**ê³¼ ê°™ìŒ
> ì´ ë°•ìŠ¤ê°€ ë°”ë¡œ DTO

---

DTOì˜ ì¥ì 
- **ì…ë ¥ ë°ì´í„° ìº¡ìŠí™”**: ìš”ì²­ ë°ì´í„°ë¥¼ ëª…í™•í•˜ê²Œ ì •ì˜.
- **ìœ íš¨ì„± ê²€ì¦ ë¶„ë¦¬**: ì—”í‹°í‹°ì™€ ë³„ë„ë¡œ ìš”ì²­ì— ëŒ€í•œ ë°ì´í„° ê²€ì¦ ê°€ëŠ¥.
- **ê°€ë…ì„± í–¥ìƒ**: ì½”ë“œê°€ ë” ëª…í™•í•˜ê³  ìœ ì§€ë³´ìˆ˜ê°€ ì‰¬ì›Œì§.

---

## ğŸ“Œ ì •ë¦¬: DTOë¥¼ ì‚¬ìš©í•˜ëŠ” ì´ìœ 

| ëª©ì            | ì„¤ëª…                         |
| ------------ | -------------------------- |
| ğŸ”’ Entity ë³´í˜¸ | DB êµ¬ì¡°ê°€ ì™¸ë¶€ì— ë…¸ì¶œë˜ì§€ ì•Šë„ë¡ ë°©ì§€     |
| ğŸ¯ ë°ì´í„° í•„í„°ë§   | í•„ìš”í•œ ë°ì´í„°ë§Œ ì „ë‹¬í•˜ê³  ì‘ë‹µì— í¬í•¨       |
| ğŸ” í•„ë“œëª… ë§¤í•‘    | í”„ë¡ íŠ¸ì™€ ë°±ì˜ í•„ë“œëª…ì´ ë‹¤ë¥¼ ë•Œ ìœ ì—°í•˜ê²Œ ë§¤í•‘  |
| âœ… ì…ë ¥ê°’ ê²€ì¦     | DTOì— ìœ íš¨ì„± ê²€ì‚¬ë¥¼ ë¶™ì—¬ ì•ˆì „í•˜ê²Œ ì²˜ë¦¬    |
| ğŸ”— ê³„ì¸µ ë¶„ë¦¬     | ê° ê³„ì¸µ ê°„ ê²°í•©ë„ë¥¼ ë‚®ì¶° êµ¬ì¡°ë¥¼ ìœ ì—°í•˜ê²Œ ìœ ì§€ |

---

@Valid ì…ë ¥ê°’ ê²€ì¦
ì—ëŸ¬ ë©”ì‹œì§€ ì»¤ìŠ¤í…€
ì•„ë˜ ì½”ë“œëŠ” ë‚˜ì¤‘ì— ìŠ¤í”„ë§ì„ í†µí•´ ìë™í™” ê°€ëŠ¥
```java
// íšŒì› ìƒì„±
@PostMapping
public ResponseEntity<?> create(
        @RequestBody @Valid MemberCreateDto dto
        // ì…ë ¥ê°’ ê²€ì¦ ì˜¤ë¥˜ ë‚´ìš©ì„ ê°–ê³ ìˆëŠ” ê°ì²´
        , BindingResult bindingResult
) {
    if (bindingResult.hasErrors()) { // ê²€ì¦ ê²°ê³¼ ì—ëŸ¬ê°€ ìˆë‹¤ë©´
        Map<String, String> errorMap = new HashMap<>();
        bindingResult.getFieldErrors().forEach(err -> {
            errorMap.put(err.getField(), err.getDefaultMessage());
        });

        log.warn("íšŒì›ê°€ì… ì…ë ¥ê°’ ì˜¤ë¥˜ê°€ ë°œìƒí•¨!");
        return ResponseEntity.badRequest().body(errorMap);
    }
}
```
ê²€ì¦í•  íŒŒë¦¬ë¯¸í„°ì— @Validë¥¼ ì¨ì¤˜ì•¼í•œë‹¤.

```java

public class MemberCreateDto {

    @Email(message = "ê³„ì •ëª…ì€ ì´ë©”ì¼ í˜•ì‹ì„ ì§€ì¼œì£¼ì„¸ìš”.")
    @NotBlank(message = "ê³„ì •ëª…ì€ í•„ìˆ˜ì…ë‹ˆë‹¤.")
    private String userAcc;

    @NotBlank(message = "ë¹„ë°€ë²ˆí˜¸ëŠ” í•„ìˆ˜ì…ë‹ˆë‹¤.")
//    @Size(min = 8, message = "8ìë¦¬ ì´ìƒìœ¼ë¡œ ì‘ì„±í•˜ì„¸ìš”.")
    @Pattern(regexp = "^(?=.*[A-Z])(?=.*[0-9])(?=.*[a-z])(?=.*[!@#$%^&*()-+=]).{8,}$", message = "ë¹„ë°€ë²ˆí˜¸ëŠ” íŠ¹ìˆ˜ë¬¸ìì™€ ìˆ«ì ì˜ë¬¸ì„ í¬í•¨í•´ì•¼ í•©ë‹ˆë‹¤.")
    private String pw;

    @NotBlank(message = "ë‹‰ë„¤ì„ì€ í•„ìˆ˜ì…ë‹ˆë‹¤.")
    private String nick;
    
    // DTOë¥¼ Entityë¡œ ë³€í™˜í•˜ëŠ” ë©”ì„œë“œ
    // ì •ì  íŒ©í† ë¦¬ ë©”ì„œë“œ íŒ¨í„´
    public static Member from(MemberCreateDto dto) {
        return Member.builder()
            .account(dto.getUserAcc())
            .password(dto.getPw())
            .nickname(dto.getNick())
            .build();
    }
}
```
ì •ì  íŒ©í† ë¦¬ ë©”ì„œë“œ íŒ¨í„´ê³¼ ì—ëŸ¬ ë©”ì‹œì§€ ì»¤ìŠ¤í…€ ë°©ë²•ì„ ì•Œ ìˆ˜ ìˆì—ˆìŒ
ë‘ê°œë¥¼ ë”°ë¡œ í’€ì–´ì„œ ì„¤ëª…í•´ì¤¬ìœ¼ë©´ ì¢‹ê² ë‹¤.




Response DTOì™€ ì‘ë‹µ Jsonì²˜ë¦¬

Response DTO
ìš”ì²­ì„ ë°›ì„ ë•Œ Entityë¥¼ ê°€ì ¸ì˜¤ë©´ í•„ìš”ì—†ëŠ” ë°ì´í„°ê¹Œì§€
ë°›ìŒ ê·¸ë˜ì„œ DTOë¥¼ ë°›ì•„ì„œ ì²˜ë¦¬í–ˆìŒ.
í•˜ì§€ë§Œ ì‘ë‹µì„ í•  ë•Œë„ Entityë¥¼ ì „ì†¡í•˜ë©´ ì¤‘ìš”í•œ ë°ì´í„°ë“¤ì„
í´ë¼ì´ì–¸íŠ¸ê°€ ë°›ê²Œ ë˜ë©°, ë³´ì•ˆìƒ ë¬¸ì œê°€ ëœë‹¤.
ê·¸ëŸ¬ë¯€ë¡œ ì‘ë‹µë„ DTOë¥¼ ë§Œë“¤ì–´ì„œ ì „ì†¡í•´ì¤˜ì•¼í•¨.

1. MemberListResponse DTO ìƒì„±
í´ë¼ì´ì–¸íŠ¸ì—ê²Œ ë©¤ë²„ ëª©ë¡ì„ ë³´ë‚´ì¤„ ë•Œ ì‚¬ìš©í•  ì‘ë‹µ DTO
```java 
@Getter @Setter
@ToString
@EqualsAndHashCode
@NoArgsConstructor
@AllArgsConstructor
@Builder
public class MemberListResponse {
    private String id;
    private String email; // accountì— ëŒ€ì‘
    private String nick; // ê°€ìš´ë° ê¸€ìë¥¼ ë§ˆìŠ¤í‚¹ (ì²«ê¸€ìë‘ ë§ˆì§€ë§‰ê¸€ì ë¹¼ê³ )

    // ì—”í„°í‹°ë¥¼ ì „ë‹¬ë°›ì•„ì„œ dtoë¡œ ë³€í™˜í•˜ëŠ” ì •ì  íŒ©í† ë¦¬ ë©”ì„œë“œ
    public static MemberListResponse from(Member member) {
        return MemberListResponse.builder()
                .id(member.getUid())
                .email(member.getAccount())
                .nick(maskingNickName(member.getNickname()))
                .build();
    }
  
    private static String maskingNickName(String originNick) {
        return originNick.charAt(0) + "*" + originNick.charAt(originNick.length() - 1);
    }
}
```

2. ì»¨íŠ¸ë¡¤ëŸ¬ì—ì„œ DTOë¥¼ ì‘ë‹µ ë°ì´í„°ë¡œ ì „ì†¡
- ì „ì²´ ì¡°íšŒ
```java
@GetMapping
public ResponseEntity<?> memberList() {
    log.trace("memberList ë©”ì„œë“œ í˜¸ì¶œë¨");
  
    log.info("/api/v5-3/members : GET - ìš”ì²­ ì‹œì‘!");
  
    List<MemberListResponse> responses = memberStore.values()
            .stream()
            .map(m -> MemberListResponse.from(m))
            .collect(Collectors.toList());
  
    if (responses.size() <= 0) {
        log.warn("íšŒì› ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤.");
        return ResponseEntity.notFound().build();
    }
  
    return ResponseEntity
            .ok()
            .body(responses);
}
```
ë§ˆì§€ë§‰ì—ëŠ” ì§ì ‘ Member ë¦¬ìŠ¤íŠ¸ë¥¼ ë°˜í™˜í•´ì£¼ëŠ”ê²Œ ì•„ë‹ˆë¼
MemberListResponse ë¦¬ìŠ¤íŠ¸ë¥¼ ë°˜í™˜í•´ì¤€ë‹¤.
ì´ë ‡ê²Œ í•¨ìœ¼ë¡œì¨ ì§ì ‘ Entityë¥¼ ë°˜í™˜í•˜ì§€ ì•Šê³  DTOë¥¼ 
ì „ë‹¬í•  ìˆ˜ ìˆì—ˆë‹¤. ê·¸ë¦¬í•˜ì—¬ ë³´ì•ˆì´ë‚˜ í´ë¼ì´ì–¸íŠ¸ê°€
í•„ìš”í•˜ì§€ ì•ŠëŠ” ì •ë³´ë¥¼ ì „ì†¡í•˜ì§€ ì•Šì„ ìˆ˜ ìˆìŒ.







ì‘ë‹µ Json ì²˜ë¦¬

@JsonProperty
- í´ë˜ìŠ¤ í•„ë“œì™€ JSON ì‘ë‹µ ë°ì´í„°ì˜ í•„ë“œ ì´ë¦„ì„ ë‹¤ë¥´ê²Œ ì„¤ì •í•  ë•Œ ì‚¬ìš©.
```java
@JsonProperty("account")
private String email;
```

@JsonIgnore
- íŠ¹ì • í•„ë“œë¥¼ JSON ì‘ë‹µì—ì„œ ì œì™¸.
- ë¯¼ê°í•œ ì •ë³´(ì˜ˆ: ë¹„ë°€ë²ˆí˜¸, ì¹´ë“œ ë²ˆí˜¸ ë“±)ë¥¼ í´ë¼ì´ì–¸íŠ¸ë¡œ ë³´ë‚´ì§€ ì•Šê¸° ìœ„í•´ ì‚¬ìš©.
```java
@JsonIgnore
private String cardNo;
```

@JsonFormat
- ë‚ ì§œ/ì‹œê°„ ë°ì´í„°ë¥¼ JSONìœ¼ë¡œ ë³€í™˜í•  ë•Œ íŠ¹ì • í˜•ì‹ì„ ì§€ì •.
```java
@JsonFormat(pattern = "yyyyë…„ MMì›” ddì¼")
private LocalDate creationTime;
```




