# ğŸ“˜ 2025ë…„ 7ì›” 16ì¼ TIL

## ğŸ”‘ ì˜¤ëŠ˜ì˜ í•µì‹¬ í‚¤ì›Œë“œ

* **ë¡œê·¸ ë ˆë²¨**
* **DTO**
* **Request DTO**
* **@Valid**
* **ì…ë ¥ê°’ ê²€ì¦**
* **ì •ì  íŒ©í† ë¦¬ ë©”ì„œë“œ íŒ¨í„´**
* **ì—ëŸ¬ ë©”ì‹œì§€ ì»¤ìŠ¤í…€**
* **Response DTO**
* **Json ì‘ë‹µ ì²˜ë¦¬**

---

## ğŸ“Œ 1. ë¡œê·¸ì˜ ê¸°ë³¸ ìš”ì†Œ

### âœ… ë¡œê·¸ê°€ í•„ìš”í•œ ì´ìœ 

* **ê°ì‚¬**, **ëª¨ë‹ˆí„°ë§**, **ì¥ì•  ë³µêµ¬**ë¥¼ ìœ„í•œ í•µì‹¬ ìˆ˜ë‹¨

### 1. ë¡œê·¸ ë‚´ìš©
### 2. ë¡œê·¸ ë ˆë²¨ - ì¤‘ìš”ë„

| ë ˆë²¨    | ì„¤ëª…                          |
| ----- | --------------------------- |
| TRACE | í•¨ìˆ˜ í˜¸ì¶œ, ê°ì²´ ìƒì„± ë“± ìƒì„¸í•œ ë‚´ë¶€ íë¦„ ì¶”ì  |
| DEBUG | ë””ë²„ê¹…ì„ ìœ„í•œ ë³€ìˆ˜ ê°’ ì¶”ì              |
| INFO  | ì¼ë°˜ì ì¸ ì‹œìŠ¤í…œ ë™ì‘ (ì‹œì‘, ì²˜ë¦¬ ë“±)      |
| WARN  | ì´ìƒ ìƒí™© (í° ë¬¸ì œëŠ” ì•„ë‹ˆì§€ë§Œ ì£¼ì˜ í•„ìš”)    |
| ERROR | ì˜ˆì™¸ ë˜ëŠ” ì¥ì•  ë°œìƒ                 |
| FATAL | ì‹œìŠ¤í…œ ì „ì²´ ì¥ì•  ìˆ˜ì¤€ì˜ ì¹˜ëª…ì  ì˜¤ë¥˜        |

### 3. ë¡œê·¸ê°€ ì°íŒ ì‹œê°„
### 4. ë¡œê·¸ê°€ ì°íŒ ìœ„ì¹˜ (íŒŒì¼ ê²½ë¡œ)

## ğŸ“Œ ë¡œê·¸ ì„¤ì •
```properties
# application.properties
logging.level.root=INFO
logging.level.com.spring.basic=DEBUG
```
* ì„¤ì •í•œ ë¡œê·¸ ë ˆë²¨ ì´ìƒì˜ ë¡œê·¸ë“¤ì´ ë³´ì„
* ì‹¤ë¬´ì—ì„œëŠ” ê±°ì˜ DEBUG ì´ìƒì˜ ë¡œê·¸ë§Œ ì‚¬ìš©í•¨
> âš ï¸ ìš´ì˜ í™˜ê²½ì—ì„œëŠ” `INFO` ìˆ˜ì¤€ìœ¼ë¡œ ì„¤ì •í•˜ì—¬ ì„±ëŠ¥ ìµœì í™”!

### âœ… ì‚¬ìš© ì˜ˆì‹œ (@Slf4j ì‚¬ìš©)

```java
@Slf4j
@RestController
public class MemberController {

    @GetMapping
    public ResponseEntity<?> memberList() {
        log.trace("ë©”ì„œë“œ í˜¸ì¶œë¨");
        log.info("íšŒì› ëª©ë¡ ìš”ì²­ ì‹œì‘");

        if (members.isEmpty()) {
            log.warn("íšŒì› ì—†ìŒ");
            return ResponseEntity.notFound().build();
        }

        try {
            // ...
        } catch (Exception e) {
            log.error("ì„œë²„ ì—ëŸ¬ ë°œìƒ", e);
            return ResponseEntity.internalServerError().body("ì„œë²„ ì—ëŸ¬ì…ë‹ˆë‹¤.");
        }

        return ResponseEntity.ok(members);
    }
}
```

---

## ğŸ“¦ 2. DTO (Data Transfer Object)

### âœ… DTOë€?

* **DTO**ëŠ” "Data Transfer Object"ì˜ ì•½ìë¡œ,
* **ê³„ì¸µ ê°„(ì˜ˆ: Controller â†” Service â†” Repository â†” Frontend) ë°ì´í„°ë¥¼ ì£¼ê³ ë°›ê¸° ìœ„í•œ ê°ì²´**

> ğŸ“¦ = í•„ìš”í•œ ë°ì´í„°ë§Œ ë‹´ì€ ì•ˆì „í•œ "íƒë°° ìƒì"

---

### âœ… DTOë¥¼ ì‚¬ìš©í•˜ëŠ” ì´ìœ 

| ëª©ì              | ì„¤ëª…                         |
| -------------- | -------------------------- |
| ğŸ”’ Entity ë³´í˜¸   | DB êµ¬ì¡° ë…¸ì¶œ ë°©ì§€                |
| ğŸ¯ í•„ìš”í•œ ë°ì´í„°ë§Œ ì „ì†¡ | ì„±ëŠ¥, ë³´ì•ˆ í–¥ìƒ                  |
| ğŸ” í•„ë“œëª… ìœ ì—° ë§¤í•‘   | í”„ë¡ íŠ¸ì™€ ë°± ê°„ í•„ë“œëª…ì´ ë‹¬ë¼ë„ ì²˜ë¦¬ ê°€ëŠ¥    |
| âœ… ì…ë ¥ê°’ ê²€ì¦ ê°€ëŠ¥    | `@Valid`, `@NotBlank` ë“± ì‚¬ìš© |
| ğŸ”— ê³„ì¸µ ê°„ ê²°í•©ë„ ê°ì†Œ | ìœ ì§€ë³´ìˆ˜ì— ìœ ë¦¬í•œ êµ¬ì¡°               |

### âœ¨ ì˜ˆì‹œ: í•„ë“œëª… ë§¤í•‘

```java
public class UserRequestDTO {
    private String id;

    @JsonProperty("pwd")
    private String password;
}
```

### âœ¨ ì˜ˆì‹œ: ì…ë ¥ê°’ ê²€ì¦

```java
public class UserRequestDTO {
    @NotBlank
    private String username;

    @Email
    private String email;

    @Size(min = 8)
    private String password;
}
```

---

## âœ… @Validì™€ ì—ëŸ¬ ë©”ì‹œì§€ ì»¤ìŠ¤í„°ë§ˆì´ì§•

### ğŸ“Œ ì»¨íŠ¸ë¡¤ëŸ¬ì—ì„œì˜ ê²€ì¦ ì²˜ë¦¬

```java
@PostMapping
public ResponseEntity<?> create(@RequestBody @Valid MemberCreateDto dto,
                                BindingResult bindingResult) {
    if (bindingResult.hasErrors()) {
        Map<String, String> errorMap = new HashMap<>();
        bindingResult.getFieldErrors().forEach(err ->
            errorMap.put(err.getField(), err.getDefaultMessage())
        );
        return ResponseEntity.badRequest().body(errorMap);
    }

    // ì •ìƒ ì²˜ë¦¬...
}
```

---

## ğŸ—ï¸ 3. ì •ì  íŒ©í† ë¦¬ ë©”ì„œë“œ íŒ¨í„´

> ê°ì²´ë¥¼ ìƒì„±í•  ë•Œ **ìƒì„±ì ëŒ€ì‹  static ë©”ì„œë“œë¥¼ ì‚¬ìš©**í•˜ëŠ” ë°©ì‹

```java
public static Member from(MemberCreateDto dto) {
    return Member.builder()
        .account(dto.getUserAcc())
        .password(dto.getPw())
        .nickname(dto.getNick())
        .build();
}
```

### ğŸ“Œ ì¥ì 

* ì´ë¦„ì„ ì¤„ ìˆ˜ ìˆì–´ **ì˜ë„ê°€ ëª…í™•**
* í•„ìš” ì‹œ **ìºì‹±**, **ë‹¤í˜•ì„± ë°˜í™˜** ë“± ìœ ì—°í•œ ì²˜ë¦¬ ê°€ëŠ¥

---

## ğŸ“¬ 4. Response DTOì™€ JSON ì‘ë‹µ ì²˜ë¦¬

### âœ… ì‘ë‹µ ì‹œì—ë„ DTOë¥¼ ì‚¬ìš©í•˜ëŠ” ì´ìœ 

* Entity ì§ì ‘ ë°˜í™˜ ì‹œ **ë¯¼ê° ì •ë³´ ë…¸ì¶œ ìœ„í—˜**
* í´ë¼ì´ì–¸íŠ¸ì— ê¼­ í•„ìš”í•œ ì •ë³´ë§Œ ì œê³µ ê°€ëŠ¥

### âœ¨ MemberListResponse ì˜ˆì‹œ

```java
@Builder
public class MemberListResponse {
    private String id;
    private String email;
    private String nick;

    public static MemberListResponse from(Member member) {
        return MemberListResponse.builder()
                .id(member.getUid())
                .email(member.getAccount())
                .nick(maskingNickName(member.getNickname()))
                .build();
    }

    private static String maskingNickName(String origin) {
        return origin.charAt(0) + "*" + origin.charAt(origin.length() - 1);
    }
}
```

### âœ¨ ì»¨íŠ¸ë¡¤ëŸ¬ ì‘ë‹µ ì²˜ë¦¬

```java
@GetMapping
public ResponseEntity<?> memberList() {
    List<MemberListResponse> responses = memberStore.values()
            .stream()
            .map(m -> MemberListResponse.from(m))
            .collect(Collectors.toList());

    return ResponseEntity.ok(responses);
}
```

---

## ğŸ§¾ 5. JSON ì‘ë‹µ ê´€ë ¨ ì–´ë…¸í…Œì´ì…˜ ì •ë¦¬

| ì–´ë…¸í…Œì´ì…˜           | ì„¤ëª…                  |
| --------------- | ------------------- |
| `@JsonProperty` | í•„ë“œëª…ì„ JSON í‚¤ì™€ ë‹¤ë¥´ê²Œ ì§€ì • |
| `@JsonIgnore`   | íŠ¹ì • í•„ë“œë¥¼ JSON ì‘ë‹µì—ì„œ ì œì™¸ |
| `@JsonFormat`   | ë‚ ì§œ/ì‹œê°„ í¬ë§· ì§€ì •         |

```java
@JsonProperty("account")
private String email;

@JsonIgnore
private String cardNo;

@JsonFormat(pattern = "yyyy-MM-dd")
private LocalDate createdAt;
```

---

## âœ¨ ì˜¤ëŠ˜ì˜ ì •ë¦¬ ìš”ì•½

| ê°œë…         | í•µì‹¬ ë‚´ìš©                                              |
| ---------- | -------------------------------------------------- |
| ë¡œê·¸ ë ˆë²¨      | TRACE \~ FATALê¹Œì§€ ìƒí™©ì— ë”°ë¼ êµ¬ë¶„                         |
| DTO        | ê³„ì¸µ ê°„ ë°ì´í„° ì „ë‹¬ ê°ì²´. ë³´ì•ˆ, ì„±ëŠ¥, ìœ ì—°ì„± í–¥ìƒ                     |
| ì…ë ¥ê°’ ê²€ì¦     | `@Valid`ì™€ `BindingResult`ë¥¼ í†µí•´ ì²˜ë¦¬                   |
| ì •ì  íŒ©í† ë¦¬ ë©”ì„œë“œ | ìƒì„±ì ëŒ€ì‹  ì˜ë¯¸ ìˆëŠ” ì´ë¦„ìœ¼ë¡œ ê°ì²´ ìƒì„±                            |
| ì‘ë‹µ DTO     | Entity ëŒ€ì‹  í•„ìš”í•œ ë°ì´í„°ë§Œ ì‘ë‹µ                              |
| JSON ì²˜ë¦¬    | `@JsonProperty`, `@JsonIgnore`, `@JsonFormat` ë“± ì‚¬ìš© |
