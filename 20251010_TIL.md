# 🗓️ 2025년 10월 10일 TIL


## 도커(Docker)
- 컨테이너(Container) 기술을 사용하여 애플리케이션을 신속하게 구축, 테스트 및 배포할 수 있게 하는 플랫폼
- 도커를 사용하면 애플리케이션과 그 종속성들을 컨테이너라는 단위로 패키징 가능
- 일관된 실행 환경을 제공

## 도커의 장점
- 빠른 배포: 도커는 애플리케이션을 컨테이너로 패키징하여 빠르게 배포 가능
- 확장성: 도커는 필요한 만큼 컨테이너를 생성하고 배포할 수 있어, 애플리케이션의 확장이 용이
- 버전 관리: 도커 이미지는 버전 관리가 가능하여, 특정 버전으로 쉽게 롤백 가능
- 격리된 환경: 도커 컨테이너는 서로 격리된 환경을 제공하여, 하나의 컨테이너에서 발생한 문제가 다른 컨테이너에 영향을 주지 않음
- 자동화: 도커는 CI/CD 파이프라인과 통합되어 자동화된 빌드 및 배포가 가능

---

## 도커의 기본 개념

### 도커 이미지
- 도커 이미지는 애플리케이션을 실행하는 데 필요한 모든 것을 포함하는 읽기 전용 템플릿
- 이미지는 계층화된 파일 시스템으로 구성되며, 각 계층은 변경 사항을 포함
- 이미지는 Dockerfile을 사용하여 생성됨

### 도커 컨테이너
- 도커 컨테이너는 도커 이미지를 실행한 것으로, 애플리케이션이 실행되는 독립적인 환경
- 컨테이너는 경량이며, 빠르게 시작, 종료 가능
- 컨테이너는 호스트 시스템의 커널을 공유하지만, 독립적인 파일 시스템, 네트워크, 프로세스 공간을 가짐
- EC2가 1GB일때, 도커 컨테이너가 4GB일 수는 없음.

### 도커허브
- 도커 이미지의 중앙 저장소
- 이미지를 저장, 공유, 배포 가능

---

## 도커 설치 및 환경설정

### Windows 도커 설치
- https://www.docker.com/products/docker-desktop/

### WSL 업데이트
- cmd `wsl --update`

### 도커 기본 명령어

1. docker version
- 도커 버전을 확인하는 명령어
- 설치된 도커의 클라이언트와 서버 버전을 보여줌

2. docker info
- 도커의 상세 정보를 확인하는 명령어
- 도커의 현재 상태, 실행 중인 컨테이너 수, 이미지 수 등의 정보를 보여줌

---

## 도커 이미지

### 도커 이미지의 구조
- 베이스 이미지(Base Image): 모든 도커 이미지는 베이스 이미지에서 시작
  - ubuntu, node, alpine 등
- 명령어(Command): Dockerfile에 정의된 명령어들은 각각의 계층을 형성
  - RUN, COPY, ADD 등
- 메타데이터(Metadata): 이미지에 대한 정보, 작성자, 버전 등이 포함

### 도커 이미지의 역할
도커 이미지는 일관된 환경을 제공하여 애플리케이션이 어디서나 동일하게 실행될 수 있도록 함
개발, 테스트, 프로덕션 환경 간의 차이를 최소화하여, 배포 및 운영의 효율성을 높임

---

## 도커 컨테이너

### 도커 컨테이너의 정의
- 도커 이미지를 실행한 상태
- 격리된 환경에서 애플리케이션 실행
- 시스템 간의 호환성 문제를 해결
- 도커 이미지는 애플리케이션의 '설계도'
- 도커 컨테이너는 이 설계도로 실제로 만들어진 '실행 중인 애플리케이션'

### 도커 컨테이너의 역할
- 애플리케이션이 항상 동일한 환경에서 실행되도록 보장
- 로컬에서 테스트한 환경과 프로덕션 환경이 일치하도록 하여, 환경 차이로 인한 문제를 방지

---

## 연습예제: 간단한 Node.js 애플리케이션 
- `https://antitifragile.notion.site/1-2938029d74bc4eff92f4275ca5cf4a8c` 참고

---

## 도커 명령어

### 도커 이미지 빌드
- `docker build -t my-node-app .`
- -t 옵션은 이미지를 태그(Tag)하는 옵션
- `.`은 Dockerfile이 있는 현재 디렉토리를 의미

### 도커 컨테이너 실행
- `docker run -d -p 8585:8585 my-node-app`
- 빌드된 이미지를 사용하여 도커 컨테이너를 실행
- -d 옵션은 컨테이너를 백그라운드에서 실행
- -p 옵션은 호스트와 컨테이너의 포트를 매핑
- 포트번호가 2개가 있는데 앞의 포트번호는 호스트포트
- 뒤의 포트번호는 도커 컨테이너 포트, Dockerfile에 지정한 포트번호

- 도커 컨테이너 이름 지정: `docker run -d -p 8585:8585 --name banana my-node-app`
  - 컨테이너의 이름을 `banana` 지정


### 현재 실행중인 컨테이너 목록
- `docker ps`
- 컨테이너 ID, IMAGE 등 확인 가능
- `docker ps -a`: 중지된 컨테이너 ID 확인

### 도커 컨테이너 중지
- `docker stop <컨테이너 ID>`

### 도커 컨테이너 삭제
- `docker rm <컨테이너 ID>`

### 도커 이미지 삭제
- `docker rmi my-node-app`

---

## 도커 파일(Docker file)
- 도커 이미지를 빌드하기 위한 설정 파일
- 이미지 생성 과정에서 필요한 명령어를 순차적으로 기술
- 베이스 이미지 선택부터 필요한 소프트웨어 설치, 환경 설정까지 이미지를 구성하는 모든 단계를 정의

### 도커 파일 기본 구조
- FROM: 이미지의 기반이 되는 베이스 이미지 지정
- WORKDIR: 컨테이너 내에서 명령어가 실행될 작업 디렉토리 설정
- COPY: 호스트의 파일이나 디렉토리를 이미지에 복사
- RUN: 이미지 빌드 과정 중 명령어를 실행
- CMD: 컨테이너가 시작될 때 실행할 명령어 설정

---

## 연습예제: 간단한 Spring Boot 애플리케이션
- `https://antitifragile.notion.site/3-Docker-file-c82905e6e01042debfb74a95a34c73c0#a275681fb5374dcd901d3bdfd55d80a3` 참고








