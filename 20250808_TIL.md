# ğŸ—“ï¸ 2025ë…„ 8ì›” 8ì¼ TIL

## ğŸ”‘ ì˜¤ëŠ˜ì˜ í‚¤ì›Œë“œ

* Spring Boot
* REST API
* ì¤‘ë³µ ì²´í¬
* JPA `existsBy...`
* Controllerâ€“Serviceâ€“Repository ê³„ì¸µ ë¶„ë¦¬
* í‘œì¤€ ì‘ë‹µ í¬ë§· `ApiResponse`

---

## 1) ì˜¤ëŠ˜ í•œ ì¼ ê°œìš”

* íšŒì›ê°€ì… UX ê°œì„ ì„ ìœ„í•´ **ì‚¬ìš©ìëª… ì¤‘ë³µ ì²´í¬ API**ì™€ **ì´ë©”ì¼ ì¤‘ë³µ ì²´í¬ API**ë¥¼ êµ¬í˜„.
* `UserRepository`ì˜ `existsBy...` ë©”ì„œë“œë¥¼ ì‚¬ìš©í•˜ì—¬ **ì¡´ì¬ ì—¬ë¶€ë§Œ ë¹ ë¥´ê²Œ í™•ì¸**.
* Controllerì—ì„œëŠ” **í‘œì¤€ ì‘ë‹µ í¬ë§·(ApiResponse)** ìœ¼ë¡œ ë©”ì‹œì§€ì™€ ë¶ˆë¦¬ì–¸ ê°’ì„ í•¨ê»˜ ë°˜í™˜.

---

## 2) êµ¬í˜„ ì½”ë“œ

### ğŸ“Œ UserRepository

```java
public interface UserRepository extends JpaRepository<User, Long> {
    Optional<User> findByUsername(String username);
    Optional<User> findByEmail(String email);

    // ì¤‘ë³µí™•ì¸
    boolean existsByUsername(String username);
    boolean existsByEmail(String email);
}
```

* `existsByUsername`, `existsByEmail`ì€ DBì—ì„œ ì¡´ì¬ ì—¬ë¶€ë§Œ ë°˜í™˜í•˜ë¯€ë¡œ **ì„±ëŠ¥ìƒ ìœ ë¦¬**.

---

### ğŸ“Œ UserService

```java
@Service
@RequiredArgsConstructor
@Transactional
@Slf4j
public class UserService {

    private final UserRepository userRepository;

    public boolean checkDuplicateUsername(String username) {
        return userRepository.existsByUsername(username);
    }

    public boolean checkDuplicateEmail(String email) {
        return userRepository.existsByEmail(email);
    }
}
```

* ë‹¨ìˆœ í˜¸ì¶œë¡œ ì¤‘ë³µ ì—¬ë¶€ë¥¼ booleanìœ¼ë¡œ ë°˜í™˜.

---

### ğŸ“Œ AuthController

```java
@RestController
@RequestMapping("/api/auth")
@Slf4j
@RequiredArgsConstructor
public class AuthController {

    private final UserService userService;

    // ì‚¬ìš©ìëª… ì¤‘ë³µ ì²´í¬
    @GetMapping("/check-username")
    public ResponseEntity<?> checkUsername(@RequestParam String username) {
        boolean exists = userService.checkDuplicateUsername(username);
        return ResponseEntity.ok()
                .body(ApiResponse.success(
                        exists ? "ì´ë¯¸ ì‚¬ìš© ì¤‘ì¸ ì‚¬ìš©ìëª…ì…ë‹ˆë‹¤." : "ì‚¬ìš© ê°€ëŠ¥í•œ ì‚¬ìš©ìëª…ì…ë‹ˆë‹¤.",
                        exists
                ));
    }

    // ì´ë©”ì¼ ì¤‘ë³µ ì²´í¬
    @GetMapping("/check-email")
    public ResponseEntity<?> checkEmail(@RequestParam String email) {
        boolean exists = userService.checkDuplicateEmail(email);
        return ResponseEntity.ok()
                .body(ApiResponse.success(
                        exists ? "ì´ë¯¸ ì‚¬ìš© ì¤‘ì¸ ì´ë©”ì¼ì…ë‹ˆë‹¤." : "ì‚¬ìš© ê°€ëŠ¥í•œ ì´ë©”ì¼ì…ë‹ˆë‹¤.",
                        exists
                ));
    }
}
```

* `ApiResponse.success(message, exists)` í˜•íƒœë¡œ **ë©”ì‹œì§€ì™€ ì¤‘ë³µ ì—¬ë¶€ë¥¼ í•¨ê»˜ ì‘ë‹µ**.

---

## 3) API ëª…ì„¸

### 1) ì‚¬ìš©ìëª… ì¤‘ë³µ ì²´í¬

* **HTTP Method / URL**
  `GET /api/auth/check-username?username={value}`

* **Query Parameters**

  | ì´ë¦„         | íƒ€ì…     | í•„ìˆ˜ | ì„¤ëª…              |
  | ---------- | ------ | -- | --------------- |
  | `username` | string | Y  | ì¤‘ë³µ ì—¬ë¶€ë¥¼ í™•ì¸í•  ì‚¬ìš©ìëª… |

* **Response: 200 OK** â€” `ApiResponse<Boolean>`

    * **ìŠ¤í‚¤ë§ˆ**

      ```json
      {
        "success": true,
        "message": "ë¬¸ìì—´",
        "timestamp": "YYYY-MM-DDTHH:mm:ss[.SSS]",
        "data": true
      }
      ```

        * `data`: `true` ì´ë©´ **ì¤‘ë³µ(ì´ë¯¸ ì‚¬ìš© ì¤‘)**, `false` ì´ë©´ **ì‚¬ìš© ê°€ëŠ¥**
    * **ì˜ˆì‹œ (ì‚¬ìš© ê°€ëŠ¥)**

      ```json
      {
        "success": true,
        "message": "ì‚¬ìš© ê°€ëŠ¥í•œ ì‚¬ìš©ìëª…ì…ë‹ˆë‹¤.",
        "timestamp": "2025-08-10T20:45:12.345",
        "data": false
      }
      ```
    * **ì˜ˆì‹œ (ì¤‘ë³µ)**

      ```json
      {
        "success": true,
        "message": "ì´ë¯¸ ì‚¬ìš© ì¤‘ì¸ ì‚¬ìš©ìëª…ì…ë‹ˆë‹¤.",
        "timestamp": "2025-08-10T20:45:15.102",
        "data": true
      }
      ```

---

### 2) ì´ë©”ì¼ ì¤‘ë³µ ì²´í¬

* **HTTP Method / URL**
  `GET /api/auth/check-email?email={value}`

* **Query Parameters**

  | ì´ë¦„      | íƒ€ì…     | í•„ìˆ˜ | ì„¤ëª…             |
  | ------- | ------ | -- | -------------- |
  | `email` | string | Y  | ì¤‘ë³µ ì—¬ë¶€ë¥¼ í™•ì¸í•  ì´ë©”ì¼ |

* **Response: 200 OK** â€” `ApiResponse<Boolean>`

    * **ìŠ¤í‚¤ë§ˆ**

      ```json
      {
        "success": true,
        "message": "ë¬¸ìì—´",
        "timestamp": "YYYY-MM-DDTHH:mm:ss[.SSS]",
        "data": true
      }
      ```

        * `data`: `true` ì´ë©´ **ì¤‘ë³µ(ì´ë¯¸ ì‚¬ìš© ì¤‘)**, `false` ì´ë©´ **ì‚¬ìš© ê°€ëŠ¥**
    * **ì˜ˆì‹œ (ì‚¬ìš© ê°€ëŠ¥)**

      ```json
      {
        "success": true,
        "message": "ì‚¬ìš© ê°€ëŠ¥í•œ ì´ë©”ì¼ì…ë‹ˆë‹¤.",
        "timestamp": "2025-08-10T20:46:03.011",
        "data": false
      }
      ```
    * **ì˜ˆì‹œ (ì¤‘ë³µ)**

      ```json
      {
        "success": true,
        "message": "ì´ë¯¸ ì‚¬ìš© ì¤‘ì¸ ì´ë©”ì¼ì…ë‹ˆë‹¤.",
        "timestamp": "2025-08-10T20:46:05.427",
        "data": true
      }
      ```

---

### ì°¸ê³  ì‚¬í•­

* ì»¨íŠ¸ë¡¤ëŸ¬ëŠ” `ApiResponse.success(message, exists)` ë¥¼ ì‚¬ìš©í•´ ìœ„ì™€ ê°™ì€ í¬ë§·ìœ¼ë¡œ ì‘ë‹µí•©ë‹ˆë‹¤.


---

## 4) ì˜¤ëŠ˜ ë°°ìš´ ì 

* `existsBy...` ë©”ì„œë“œëŠ” ì¡´ì¬ ì—¬ë¶€ë¥¼ í™•ì¸í•  ë•Œ íš¨ìœ¨ì ì´ë©°, ì—”í‹°í‹° ë¡œë”© ì—†ì´ ì²˜ë¦¬ ê°€ëŠ¥.
* API ì‘ë‹µì— **ë©”ì‹œì§€ì™€ ìƒíƒœê°’ì„ í•¨ê»˜ ì œê³µ**í•˜ë©´ í”„ë¡ íŠ¸ì—”ë“œì—ì„œ ì²˜ë¦¬ ë¡œì§ì„ ë‹¨ìˆœí™”í•  ìˆ˜ ìˆë‹¤.
* ì»¨íŠ¸ë¡¤ëŸ¬â€“ì„œë¹„ìŠ¤â€“ë¦¬í¬ì§€í† ë¦¬ ê³„ì¸µ ë¶„ë¦¬ë¥¼ í†µí•´ ìœ ì§€ë³´ìˆ˜ì„±ì„ ë†’ì¼ ìˆ˜ ìˆë‹¤.

