# 🗓️ 2025년 8월 5일 TIL

## 📌 오늘 한 일

* **토이 프로젝트 생성**

    * **Spring Boot**: 3.5.4
    * **프로젝트 이름**: `spring-toy-project`
    * **Artifact**: `toyproject`
    * **JDK**: Corretto-17 (Amazon Corretto)
    * **Java 버전**: 17
    * **패키징**: Jar

* **추가 종속성**

    * Spring Boot DevTools
    * Lombok
    * Spring Web
    * Thymeleaf
    * Spring Data JPA
    * MariaDB Driver

---

## 👤 사용자 엔터티 설계

### 핵심 포인트

* 인증 시스템의 **핵심 엔터티**로서 기본 사용자 정보를 관리
* `id`, `생성시간`, `수정시간`은 자동 생성
* 패스워드는 \*\*암호화(해시)\*\*되어 저장되므로 DB 컬럼 길이를 넉넉하게 설정

```java
@Entity
@Table(name = "tbl_user")
@Getter
@ToString
@EqualsAndHashCode(of = "id")
@NoArgsConstructor(access = AccessLevel.PROTECTED)
public class User {

    @Id
    @GeneratedValue(strategy = GenerationType.IDENTITY)
    @Column(name = "user_id")
    private Long id;

    @Column(name = "user_name", unique = true, nullable = false, length = 50)
    private String username;

    @Column(name = "user_email", unique = true, nullable = false, length = 100)
    private String email;

    @Column(name = "password", nullable = false, length = 255)
    private String password;
    
    @CreationTimestamp
    @Column(nullable = false, updatable = false)
    private LocalDateTime createdAt;

    @UpdateTimestamp
    @Column(nullable = false)
    private LocalDateTime updatedAt;
    
    @Builder
    public User(String username, String email, String password) {
        this.username = username;
        this.email = email;
        this.password = password;
    }
}
```

#### 📍 설계 이유

* **`@EqualsAndHashCode(of = "id")`**: `id`가 같으면 동일 객체로 판단
* **패스워드 길이 255**: 해시 처리 시 길이가 길어질 수 있어 여유있게 설정
* **생성/수정 시간 필드**: 모든 테이블에서 기본적으로 필요

---

## 📂 UserRepository 생성

```java
public interface UserRepository extends JpaRepository<User, Long> {

    // 로그인 시, 사용자 이름 또는 이메일로 검색
    Optional<User> findByUsername(String username);
    Optional<User> findByEmail(String email);

    // 중복 체크
    boolean existsByUsername(String username);
    boolean existsByEmail(String email);
}
```

#### 📍 설계 이유

* 로그인 시 숫자 `id` 대신 `username` 또는 `email`을 사용
* 회원가입 시 **중복 방지 로직** 구현 가능

---

## 📝 오늘의 학습 정리

* **Entity 설계 시 주의점**

    1. `id`, `createdAt`, `updatedAt`은 자동 관리
    2. 패스워드는 해시 저장 → 컬럼 길이 넉넉히
    3. `@Builder` 사용 시, 자동 생성되는 값은 빌더에 포함하지 않음

* **Repository 설계 시 주의점**

    1. 로그인 검색은 `username`/`email` 기반
    2. 회원가입 전 중복 체크 메서드 구현

