
# ğŸ—“ï¸ 2025ë…„ 7ì›” 21ì¼ TIL

## âœ… ì˜¤ëŠ˜ì˜ í•µì‹¬ í‚¤ì›Œë“œ

* ì˜ˆì™¸ë€ ë¬´ì—‡ì¸ê°€?
* ì²´í¬ ì˜ˆì™¸ vs ì–¸ì²´í¬ ì˜ˆì™¸
* Spring MVCì˜ ì˜ˆì™¸ ì²˜ë¦¬ íë¦„
* `@ExceptionHandler`, `@RestControllerAdvice`
* ì‚¬ìš©ì ì •ì˜ ì˜ˆì™¸, ì—ëŸ¬ ì½”ë“œ Enum, ì—ëŸ¬ ì‘ë‹µ DTO

---

## ğŸ“Œ ì˜ˆì™¸ë€?

* **ì˜ˆìƒì¹˜ ëª»í•œ ìƒí™©**ìœ¼ë¡œ ì¸í•´ í”„ë¡œê·¸ë¨ì´ ì •ìƒ íë¦„ì„ ë²—ì–´ë‚˜ëŠ” ê²ƒ
* ì˜ˆì‹œ: ë„¤íŠ¸ì›Œí¬ ëŠê¹€, DB ì—°ê²° ì‹¤íŒ¨, ì¤‘ë³µëœ ì•„ì´ë”” ë“±

### ì²´í¬ ì˜ˆì™¸ (Checked Exception)

> **ë°˜ë“œì‹œ ì²˜ë¦¬í•´ì•¼ í•˜ëŠ” ì˜ˆì™¸**. ì»´íŒŒì¼ëŸ¬ê°€ í™•ì¸í•¨.

* ì˜ˆì‹œ:

    * íŒŒì¼ì´ ì¡´ì¬í•˜ì§€ ì•ŠìŒ
    * DB ì—°ê²° ì‹¤íŒ¨
    * ì™¸ë¶€ API í˜¸ì¶œ ì‹¤íŒ¨
* ë¹„ìœ : ìë™ì°¨ ìš´ì „ ì „ **ì•ˆì „ë²¨íŠ¸ ì°©ìš© ì—¬ë¶€ í™•ì¸**

### ì–¸ì²´í¬ ì˜ˆì™¸ (Unchecked Exception)

> **í”„ë¡œê·¸ë˜ë¨¸ ì‹¤ìˆ˜ë¡œ ë°œìƒí•˜ëŠ” ì˜ˆì™¸**. ì»´íŒŒì¼ëŸ¬ê°€ í™•ì¸í•˜ì§€ ì•ŠìŒ.

* ì˜ˆì‹œ:

    * ë°°ì—´ ë²”ìœ„ ì´ˆê³¼
    * null ê°ì²´ ì‚¬ìš©

---

## âš ï¸ ì˜ˆì™¸ ì²˜ë¦¬ê°€ í•„ìš”í•œ ì´ìœ 

| ë‚˜ìœ ì²˜ë¦¬ ë°©ì‹      | ì¢‹ì€ ì²˜ë¦¬ ë°©ì‹               |
| ------------- | ---------------------- |
| í”„ë¡œê·¸ë¨ì´ ê°‘ìê¸° ì¢…ë£Œë¨ | ì‚¬ìš©ìì—ê²Œ ë¬¸ì œë¥¼ ì•ˆë‚´í•˜ê³  ëŒ€ì•ˆì„ ì œì‹œí•¨ |

---

## ğŸ› ï¸ ì˜ˆì™¸ ì²˜ë¦¬ íë¦„ (Spring MVC ê¸°ì¤€)

1. ì»¨íŠ¸ë¡¤ëŸ¬/ì„œë¹„ìŠ¤ì—ì„œ ì˜ˆì™¸ ë°œìƒ
2. ì˜ˆì™¸ê°€ `DispatcherServlet`ê¹Œì§€ ì „ë‹¬ë¨
3. `@ExceptionHandler` ë˜ëŠ” `@ControllerAdvice`ê°€ ì˜ˆì™¸ ì²˜ë¦¬
4. í´ë¼ì´ì–¸íŠ¸ì—ê²Œ ì‘ë‹µ ë°˜í™˜

---

## ğŸ” ê¸°ë³¸ ì˜ˆì™¸ ì²˜ë¦¬ ë°©ì‹

### 1. try-catch ì˜ˆì‹œ

```java
try {
    ë°ì´í„°ë² ì´ìŠ¤ì—ì„œ_íšŒì›ì •ë³´_ì¡°íšŒ();
} catch (Exception e) {
    ê´€ë¦¬ìì—ê²Œ_ë¬¸ì œ_ë°œìƒ_ì•Œë¦¬ê¸°();
}
```

### 2. throws ì˜ˆì‹œ

```java
public void readFile() throws IOException {
    // ì˜ˆì™¸ëŠ” í˜¸ì¶œí•œ ìª½ì—ì„œ ì²˜ë¦¬í•˜ë„ë¡ ë˜ì§
}
```

---

## ğŸ¯ Springì˜ ì˜ˆì™¸ ì²˜ë¦¬ ë„êµ¬

### @ExceptionHandler

```java
@ExceptionHandler(ProductNotFoundException.class)
public ResponseEntity<String> handleProductNotFound() {
    return ResponseEntity.status(404).body("ì£„ì†¡í•©ë‹ˆë‹¤. ì°¾ìœ¼ì‹œëŠ” ìƒí’ˆì´ ì—†ìŠµë‹ˆë‹¤.");
}
```

### @ControllerAdvice vs @RestControllerAdvice

| í•­ëª©    | @ControllerAdvice | @RestControllerAdvice |
| ----- | ----------------- | --------------------- |
| ì‚¬ìš© í™˜ê²½ | ì›¹ í˜ì´ì§€             | REST API              |
| ì‘ë‹µ í˜•ì‹ | View, JSON, XML   | JSON                  |
| íŠ¹ì§•    | HTML ë°˜í™˜ ê°€ëŠ¥        | `@ResponseBody` ìë™ í¬í•¨ |

> âœ… ì›¹ì‚¬ì´íŠ¸ â†’ `@ControllerAdvice`
> âœ… API ì„œë²„ â†’ `@RestControllerAdvice`

---

## ğŸ’¡ ì˜ˆì™¸ ì²˜ë¦¬ íŒ¨í„´ ì‹¤ìŠµ

> ì•„ë˜ ì½”ë“œëŠ” `MemberService` í´ë˜ìŠ¤ì—ì„œ íšŒì› ì •ë³´ë¥¼ ì¡°íšŒí•  ë•Œ ë°œìƒí•  ìˆ˜ ìˆëŠ” ë‹¤ì–‘í•œ ì˜ˆì™¸ ìƒí™©ì„ ì²˜ë¦¬í•˜ëŠ” ì˜ˆì œì…ë‹ˆë‹¤.

```java
@Service
@Slf4j
@RequiredArgsConstructor
public class MemberService {

    private final MemberRepository memberRepository;

    public MemberListResponse findOneMember(String account) {
        log.info("íšŒì› ê°œë³„ ì¡°íšŒ ìš”ì²­");
```

> ğŸ‘‰ **ë¡œê¹…**ìœ¼ë¡œ ìš”ì²­ íë¦„ì„ ì¶”ì í•  ìˆ˜ ìˆë„ë¡ ë¡œê·¸ë¥¼ ë‚¨ê¹€

---

### ğŸ”¹ \[1ë‹¨ê³„] ì…ë ¥ê°’ ê²€ì¦

```java
        if (account.length() > 10) {
            throw new MemberException(ErrorCode.ACCOUNT_TOO_LONG);
        }
```

> * **ì‚¬ìš©ì ì…ë ¥ê°’ ê²€ì¦ (Validation)**
> * ê³„ì •ëª…ì´ ë„ˆë¬´ ê¸¸ë©´ `ACCOUNT_TOO_LONG`ì´ë¼ëŠ” ì»¤ìŠ¤í…€ ì˜ˆì™¸ë¥¼ ë˜ì§
> * ì´ë ‡ê²Œ í•˜ë©´ ì»¨íŠ¸ë¡¤ëŸ¬ì—ì„œ ifë¬¸ì„ ë°˜ë³µí•˜ì§€ ì•Šê³ , ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ì— ì§‘ì¤‘í•  ìˆ˜ ìˆìŒ

---

### ğŸ”¹ \[2ë‹¨ê³„] DB ì¡°íšŒ & ë„ ì²´í¬

```java
        Member foundMember = memberRepository.findByAccount(account);

        if (foundMember == null) {
            throw new MemberException(ErrorCode.MEMBER_NOT_FOUND);
        }
```

> * **ë ˆí¬ì§€í† ë¦¬(DAO)ì—ì„œ ë°ì´í„° ì¡°íšŒ**
> * ë§Œì•½ ì‚¬ìš©ìê°€ ì¡´ì¬í•˜ì§€ ì•Šìœ¼ë©´, `MEMBER_NOT_FOUND` ì˜ˆì™¸ ë°œìƒ
> * ì¦‰, **ì…ë ¥ì€ ë§ëŠ”ë° ë°ì´í„°ê°€ ì—†ìŒ** â†’ ì ì ˆí•œ ì˜ˆì™¸ ì²˜ë¦¬ í•„ìš”

---

### ğŸ”¹ \[3ë‹¨ê³„] DTO ë³€í™˜ ë° ì‘ë‹µ ë°˜í™˜

```java
        return MemberListResponse.from(foundMember);
    }
}
```

> * **Entityë¥¼ ì§ì ‘ ë°˜í™˜í•˜ì§€ ì•Šê³  DTOë¡œ ë³€í™˜**
> * ì™¸ë¶€ì— ë…¸ì¶œí•˜ë©´ ì•ˆ ë˜ëŠ” ì •ë³´(User password ë“±)ëŠ” ê±¸ëŸ¬ë‚´ê³ ,
    >   í•„ìš”í•œ ì •ë³´ë§Œ ì •ì œí•´ì„œ ì‘ë‹µì— ë‹´ìŒ

---

### ğŸ“Œ ì´ íŒ¨í„´ì´ ì¤‘ìš”í•œ ì´ìœ 

| í¬ì¸íŠ¸        | ì„¤ëª…                              |
| ---------- | ------------------------------- |
| â—ì…ë ¥ê°’ ê²€ì¦    | ì˜¤ë¥˜ë¥¼ ë¹ ë¥´ê²Œ ì°¨ë‹¨í•˜ê³ , ë¶ˆí•„ìš”í•œ DB ì¡°íšŒë¥¼ ë°©ì§€    |
| â—ëª…í™•í•œ ì˜ˆì™¸ ë¶„ê¸° | ì–´ë–¤ ìƒí™©ì—ì„œ ì–´ë–¤ ì˜ˆì™¸ê°€ ë°œìƒí–ˆëŠ”ì§€ ëª…í™•í•˜ê²Œ êµ¬ë¶„ ê°€ëŠ¥ |
| â—DTO ë³€í™˜    | ì‘ë‹µì˜ ì¼ê´€ì„±ê³¼ ë³´ì•ˆì„±ì„ ìœ ì§€                |

---

### ğŸ”„ íë¦„ ìš”ì•½

```
[ì…ë ¥ê°’ ê²€ì¦] â†’ [DBì¡°íšŒ] â†’ [ë„ ì²´í¬] â†’ [DTO ì‘ë‹µ]
      â†“               â†“             â†“
  ì»¤ìŠ¤í…€ ì˜ˆì™¸     ì»¤ìŠ¤í…€ ì˜ˆì™¸     ì •ìƒ ì‘ë‹µ
```

---

```java
@Service
@Slf4j
@RequiredArgsConstructor
public class MemberService {

    private final MemberRepository memberRepository;

    public MemberListResponse findOneMember(String account) {
        log.info("íšŒì› ê°œë³„ ì¡°íšŒ ìš”ì²­");

        if (account.length() > 10) {
            throw new MemberException(ErrorCode.ACCOUNT_TOO_LONG);
        }

        Member foundMember = memberRepository.findByAccount(account);
        if (foundMember == null) {
            throw new MemberException(ErrorCode.MEMBER_NOT_FOUND);
        }

        return MemberListResponse.from(foundMember);
    }
}
```

---

## ğŸ§± ì‚¬ìš©ì ì •ì˜ ì˜ˆì™¸ í´ë˜ìŠ¤

```java
@Getter
public class MemberException extends RuntimeException {

    private final int status;
    private final String errorName;

    public MemberException(ErrorCode errorCode) {
        super(errorCode.getErrorMessage());
        this.status = errorCode.getStatusCode();
        this.errorName = errorCode.toString();
    }
}
```

---

## ğŸ“¦ GlobalExceptionHandler ì˜ˆì œ

- APIì—ì„œ ë°œìƒí•˜ëŠ” ìˆ˜ë§ì€ ì˜ˆì™¸ìƒí™©ë“¤ì„ ë„ë§¡ì•„ì„œ ì²˜ë¦¬í•˜ëŠ” í´ë˜ìŠ¤

```java
@Slf4j
@ControllerAdvice
public class GlobalExceptionHandler {

    // ì˜ˆì™¸ì²˜ë¦¬ ë©”ì„œë“œ
    @ExceptionHandler(MemberException.class)
    public ResponseEntity<?> handleMemberException(
            MemberException e,
            HttpServletRequest request
    ) {
        log.warn("ì˜ˆì™¸ ë°œìƒ: {}", e.getMessage());

        // êµ¬ì²´ì ì¸ ì—ëŸ¬ ì •ë³´ ê°ì²´ë¥¼ ìƒì„±
        ErrorResponse errorResponse = ErrorResponse.builder()
            .status(e.getStatus())
            .error(e.getErrorName())
            .message(e.getMessage())
            .path(request.getRequestURI())
            .timestamp(LocalDateTime.now())
            .build();

        return ResponseEntity.status(e.getStatus()).body(errorResponse);
    }
}
```

* `@ControllerAdvice`: ì»¨íŠ¸ë¡¤ëŸ¬ ëŒ€ì‹  ì˜ˆì™¸ì²˜ë¦¬ë¥¼ í•´ì£¼ëŠ” ë¼ì´ë¸ŒëŸ¬ë¦¬

---

## ğŸ” ì—ëŸ¬ ì½”ë“œ Enum ê´€ë¦¬

```java
@Getter
@AllArgsConstructor
public enum ErrorCode {
    MEMBER_NOT_FOUND(404, "íšŒì›ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤."),
    ACCOUNT_TOO_LONG(400, "ê³„ì •ëª…ì€ 10ê¸€ì ì´ë‚´ì—¬ì•¼ í•©ë‹ˆë‹¤.");
    
    private final int statusCode;
    private final String errorMessage;
}
```

---

## ğŸ“¤ ErrorResponse DTO êµ¬ì¡°

```java
public class ErrorResponse {
    private LocalDateTime timestamp;
    private int status;
    private String error;
    private String message;
    private String path;
}
```

---

## ğŸ§  ì˜¤ëŠ˜ì˜ ìš”ì•½

* ì˜ˆì™¸ ì²˜ë¦¬ëŠ” ì‚¬ìš©ì ê²½í—˜ê³¼ ì‹œìŠ¤í…œ ì•ˆì •ì„±ì„ ìœ„í•´ í•„ìˆ˜
* Springì—ì„œëŠ” `@ExceptionHandler`, `@ControllerAdvice`, `@RestControllerAdvice`ë¡œ êµ¬ì¡°ì ìœ¼ë¡œ ì²˜ë¦¬ ê°€ëŠ¥
* ì‚¬ìš©ì ì •ì˜ ì˜ˆì™¸ + ì—ëŸ¬ ì½”ë“œ Enum + DTO íŒ¨í„´ìœ¼ë¡œ í™•ì¥ì„±ê³¼ ìœ ì§€ë³´ìˆ˜ì„± í™•ë³´
* ì—ëŸ¬ëŠ” â€œë¡œê·¸ë¡œ ê¸°ë¡í•˜ê³ , ë©”ì‹œì§€ë¡œ ì•ˆë‚´í•˜ê³ , ì‘ë‹µìœ¼ë¡œ êµ¬ì¡°í™”â€í•˜ëŠ” ê²ƒì´ í•µì‹¬



