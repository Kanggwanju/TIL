# 🗓️ 2025년 7월 14일 TIL

쿼리 매개변수
@RequestParam
? 뒤에 있는 값을 읽음

경로변수
@PathVariable
?를 사용하지 않고 /144/1222같이 경로를 사용해서 변수를 사용



```java
@GetMapping("/{id}")
public Product getProduct(@PathVariable("id") long id) {
    return productMap.get(id);
}
```

@GetMapping("/{id}"), id는 계속 변하는 값

파라미터 long id와 겟핑의 {} 안에 있는 변수 이름이 같다면
("id")을 생략 가능
localhost:9000/products/1    -> 1번 상품 조회
[

요청 메서드 처리
- HTTP 메서드는 을 정의
- Spring MVC에서는 이를 처리하기 위해 @GetMapping, @PostMapping, @PutMapping, @DeleteMapping 등의 애노테이션을 사용

주요 HTTP 메서드 및 용도
1. GET
- 데이터를 서버에서 조회하기 위한 요청
- 서버 상태를 변경하지 않음
- **캐싱**이 가능하여 자주 사용됨
2. POST
- 데이터를 서버에 생성하거나 전송하기 위한 요청
- 일반적으로 폼 제출, 새 데이터 생성 등에 사용
3. PUT - 전체 수정 / PATCH - 일부 수정
- 데이터를 수정하거나 전체를 대체하기 위한 요청
- 주로 리소스 업데이트 작업에 사용
4. DELETE
- 데이터를 삭제하기 위한 요청


DB를 만들 때 객체를 유일하게 구분할 수 있는 식별자가 있으면 좋음
private Long id; 
id를 Long 타입으로 정한 이유는 기본값으로 null을 주기 위함
null과 0의차이 : null은 가격자체가 설정이 안된것, 0은 그냥 0원




BookController2_4
목록 조회

?sort=[ id | title | price ]
- 기본값은 id 오름차, title은 가나다순, price는 내림차

```java
//    @RequestMapping(method = RequestMethod.GET)
    @GetMapping
    public Map<String, Object> list(@RequestParam(defaultValue = "id") String sort) {
    
        List<Book> bookList = new ArrayList<>(bookStore.values())
            .stream()
            .sorted(getComparator(sort))
            .collect(Collectors.toList());

        int count = bookStore.size();

        return Map.of(
            "count", count,
            "bookList", bookList
        );
    }
```

@RequestParam(defaultValue = "id") String sort
GET방식으로 해당 메서드를 실행시킬 때 아무것도 입력하지
않아도 기본은 sort=id가 되게끔 만들어줌



bookStore.values()
bookStore의 타입은 Map<Long, Book>으로
키가 id 값이고, 값이 Book 객체이다.
bookStore.values()을 하면 값들이 반환되며,
이 값들을 이용하여 리스트를 만들어줌.


.sorted(getComparator(sort))
GET 방식으로 얻은 sort 값을 getComparator 메서드의 매개변수로 넣어줌.
getComparator는 sort 값에 따라 다른 방식으로 정렬을 실행
결과물은 List로 묶어줬음.
Map.of를 리턴하여 JSON 객체를 리턴하는 효과를 가져옴.


도서 생성
도서 생성을 할 때는 PostMapping 방식이므로 웹사이트의
URL을 통해 실행할 수 없다.

터미널을 통해 실행 가능
curl.exe -X POST "http://localhost:9000/api/v2-4/books" -d "title=서유기&author=손오공&price=1000"


도서 수정
```java
@PutMapping("/{id}")
public String updateBook(
        String title,
        String author,
        int price,
        @PathVariable Long id
) {
    Book foundBook = bookStore.get(id);


    if (foundBook == null) {
        return id + "번 도서는 존재하지 않습니다.";
    }

    foundBook.updateBookInfo(title, author, price);
    return "도서 수정 완료: id - " + id;
}
```

도서 수정도 PUT 형식이기 때문에 URL을 통해서 실행 불가능
curl.exe -X PUT "http://localhost:9000/api/v2-4/books/2" -d "title=산&author=판주&price=111"
-> id가 2인 도서를 제목 산, 저자 판주, 가격 111로 변경

updateBookInfo는 Book 클래스가 가지고 있는 메서드로서
Book 객체의 정보를 변경해줌



컨트롤러에서 다양한 데이터 응답
```java
// 페이지 라우팅 - 특정 뷰 (JSP, thymeleaf)를 포워딩 해주는 것
@GetMapping("/book-page")
public String bookPage() {
    return "book-page";
}
```

```java
// 클라이언트에게 데이터 응답
// html 응답
@GetMapping("/show/html")
@ResponseBody // 순수 데이터를 클라이언트에게 전달
public String html() {
    return """
            <html>
            <body>
                <h1>HTML 응답하기</h1>
            </body>
            </html>
        """;
}

```



마임타입
```java
// 순수 텍스트 응답하기
@GetMapping(value = "/show/text", produces = "text/plain")
@ResponseBody // 2가지 : JSON이거나 HTML
public String text() {
    return "하이 난 문자야~~";
}
```
ResponseBody는 JSON이거나 HTML으로 분류해서 보낸다.
위의 문자열은 HTML으로 분류됨.
따라서 텍스트만 보낼 때는 텍스트임을 GetMapping의 파라미터를
이용해서 마임타입을 밝힘
실무에서는 무조건 JSON으로만 데이터를 보내는 것을 기억하자.


```java
// JSON 배열 응답 - 자바 배열이나 리스트, 셋
@GetMapping("/json/array")
@ResponseBody
public List<String> hobbies() {
    return List.of("테니스", "수학문제풀기", "탁구");
}
```

```java
// JSON 객체 응답 - 자바의 클래스의 인스턴스(객체) or Map
@GetMapping("/json/object")
@ResponseBody
public Map<String, Object> myPet() {
    return Map.of(
        "name", "야옹이",
        "age", 3,
        "kind", "코숏"
    );
}
```

```java
@GetMapping("/json/object2")
@ResponseBody
public Pet myPet2() {
    return new Pet("냥냥이", 5, "페르시안", true);
}
```

```java
@GetMapping("/json/object3")
@ResponseBody
public List<Pet> myPet3() {
    return List.of(
        new Pet("냥냥이1", 5, "페르시안", true),
        new Pet("냥냥이2", 7, "페르시안2", false),
        new Pet("냥냥이3", 6, "페르시안3", true),
        new Pet("냥냥이4", 8, "페르시안4", false)
    );
}
```


