# 🗓️ 2025년 7월 28일 TIL - SQL 정리


`SELF JOIN`
- 테이블이 자기 자신과 조인하는 아주 독특한 방식
- 식별자 조심
- 유저 이름, 매니저 아이디, 매니저 이름(유저 이름)
- LEFT OUTER JOIN 으로 U1의 MANAGER_ID가 `NULL`이여도 나타나게 만들음

```sql
SELECT
  U1.USER_ID,
  U1.USERNAME,
  U1.MANAGER_ID,
  NVL(U2.USERNAME, '상사없음') AS MANAGER_NAME
FROM USERS U1
LEFT JOIN USERS U2
ON U1.MANAGER_ID = U2.USER_ID
ORDER BY U1.USER_ID
;
```

---

`CROSS JOIN`
- 모든 경우의 수 조합
- 카티션 곱
```sql
SELECT *
FROM EMPLOYEES, DEPARTMENTS
;

SELECT *
FROM EMPLOYEES
CROSS JOIN DEPARTMENTS
;
```

---

`NATURAL JOIN`과 `USING`

`NATURAL JOIN`
- 두 테이블에서 이름이 같은 모든 컬럼을 알아서 찾아서 조인 조건으로 사용
- 의도치 않은 컬럼까지 조인 조건에 포함될 수 있어 위험

`USING(컬럼명)`
- `NATURAL JOIN`보다 안전한 방법
- 이름이 같은 여러 컬럼 중 조인 조건으로 사용할 컬럼을 직접 지정

```sql
-- NATURAL JOIN은 공통 조인 매칭컬럼의 별칭을 표기해선 안된다.
SELECT
    USER_ID,
    U.USERNAME,
    UP.FULL_NAME
FROM USERS U
NATURAL JOIN USER_PROFILES UP
-- ON U.USER_ID = UP.USER_ID
;


-- ON u.user_id = p.user_id 대신 USING(user_id)를 사용
SELECT
    user_id,
    u.username,
    p.full_name
FROM
    USERS u
        INNER JOIN
    USER_PROFILES p
USING (user_id); -- user_id 컬럼을 기준으로 조인
```


